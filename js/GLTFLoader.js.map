{"version":3,"file":"GLTFLoader.js","sources":["../../node_modules/three/src/core/InterleavedBuffer.js","../../node_modules/three/src/core/InterleavedBufferAttribute.js","../../node_modules/three/src/cameras/OrthographicCamera.js","../../node_modules/three/src/materials/LineBasicMaterial.js","../../node_modules/three/src/materials/MeshStandardMaterial.js","../../node_modules/three/src/materials/MeshPhysicalMaterial.js","../../node_modules/three/src/materials/PointsMaterial.js","../../node_modules/three/src/objects/Bone.js","../../node_modules/three/src/lights/LightShadow.js","../../node_modules/three/src/lights/DirectionalLightShadow.js","../../node_modules/three/src/lights/DirectionalLight.js","../../node_modules/three/src/lights/PointLightShadow.js","../../node_modules/three/src/lights/PointLight.js","../../node_modules/three/src/lights/SpotLightShadow.js","../../node_modules/three/src/lights/SpotLight.js","../../node_modules/three/src/loaders/Cache.js","../../node_modules/three/src/loaders/LoadingManager.js","../../node_modules/three/src/loaders/Loader.js","../../node_modules/three/src/loaders/FileLoader.js","../../node_modules/three/src/loaders/ImageBitmapLoader.js","../../node_modules/three/src/loaders/LoaderUtils.js","../../node_modules/three/src/loaders/ImageLoader.js","../../node_modules/three/src/loaders/TextureLoader.js","../../node_modules/three/src/objects/Line.js","../../node_modules/three/src/objects/LineLoop.js","../../node_modules/three/src/objects/LineSegments.js","../../node_modules/three/src/objects/Points.js","../../node_modules/three/src/objects/Skeleton.js","../../node_modules/three/src/objects/SkinnedMesh.js","../../node_modules/three/src/textures/CanvasTexture.js","../../src/lib/three/GLTFLoader.js"],"sourcesContent":["import { MathUtils } from '../math/MathUtils.js';\nimport { StaticDrawUsage } from '../constants.js';\n\nfunction InterleavedBuffer( array, stride ) {\n\n\tthis.array = array;\n\tthis.stride = stride;\n\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\tthis.usage = StaticDrawUsage;\n\tthis.updateRange = { offset: 0, count: - 1 };\n\n\tthis.version = 0;\n\n\tthis.uuid = MathUtils.generateUUID();\n\n}\n\nObject.defineProperty( InterleavedBuffer.prototype, 'needsUpdate', {\n\n\tset: function ( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n} );\n\nObject.assign( InterleavedBuffer.prototype, {\n\n\tisInterleavedBuffer: true,\n\n\tonUploadCallback: function () {},\n\n\tsetUsage: function ( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.count = source.count;\n\t\tthis.stride = source.stride;\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t},\n\n\tcopyAt: function ( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( let i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tset: function ( value, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t},\n\n\tclone: function ( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = MathUtils.generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = this.array.slice( 0 ).buffer;\n\n\t\t}\n\n\t\tconst array = new this.array.constructor( data.arrayBuffers[ this.array.buffer._uuid ] );\n\n\t\tconst ib = new InterleavedBuffer( array, this.stride );\n\t\tib.setUsage( this.usage );\n\n\t\treturn ib;\n\n\t},\n\n\tonUpload: function ( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t},\n\n\ttoJSON: function ( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\t// generate UUID for array buffer if necessary\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = MathUtils.generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = Array.prototype.slice.call( new Uint32Array( this.array.buffer ) );\n\n\t\t}\n\n\t\t//\n\n\t\treturn {\n\t\t\tuuid: this.uuid,\n\t\t\tbuffer: this.array.buffer._uuid,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tstride: this.stride\n\t\t};\n\n\t}\n\n} );\n\nexport { InterleavedBuffer };\n","import { Vector3 } from '../math/Vector3.js';\nimport { BufferAttribute } from './BufferAttribute.js';\n\nconst _vector = new Vector3();\n\nfunction InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, normalized ) {\n\n\tthis.name = '';\n\n\tthis.data = interleavedBuffer;\n\tthis.itemSize = itemSize;\n\tthis.offset = offset;\n\n\tthis.normalized = normalized === true;\n\n}\n\nObject.defineProperties( InterleavedBufferAttribute.prototype, {\n\n\tcount: {\n\n\t\tget: function () {\n\n\t\t\treturn this.data.count;\n\n\t\t}\n\n\t},\n\n\tarray: {\n\n\t\tget: function () {\n\n\t\t\treturn this.data.array;\n\n\t\t}\n\n\t},\n\n\tneedsUpdate: {\n\n\t\tset: function ( value ) {\n\n\t\t\tthis.data.needsUpdate = value;\n\n\t\t}\n\n\t}\n\n} );\n\nObject.assign( InterleavedBufferAttribute.prototype, {\n\n\tisInterleavedBufferAttribute: true,\n\n\tapplyMatrix4: function ( m ) {\n\n\t\tfor ( let i = 0, l = this.data.count; i < l; i ++ ) {\n\n\t\t\t_vector.x = this.getX( i );\n\t\t\t_vector.y = this.getY( i );\n\t\t\t_vector.z = this.getZ( i );\n\n\t\t\t_vector.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetX: function ( index, x ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t},\n\n\tsetY: function ( index, y ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetZ: function ( index, z ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetW: function ( index, w ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t},\n\n\tgetX: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\n\n\t},\n\n\tgetY: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t},\n\n\tgetZ: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t},\n\n\tgetW: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t},\n\n\tsetXY: function ( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetXYZ: function ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetXYZW: function ( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t},\n\n\tclone: function ( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( new this.array.constructor( array ), this.itemSize, this.normalized );\n\n\t\t} else {\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.clone( data );\n\n\t\t\t}\n\n\t\t\treturn new InterleavedBufferAttribute( data.interleavedBuffers[ this.data.uuid ], this.itemSize, this.offset, this.normalized );\n\n\t\t}\n\n\t},\n\n\ttoJSON: function ( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// deinterleave data and save it as an ordinary buffer attribute for now\n\n\t\t\treturn {\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\ttype: this.array.constructor.name,\n\t\t\t\tarray: array,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t} else {\n\n\t\t\t// save as true interlaved attribtue\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.toJSON( data );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tisInterleavedBufferAttribute: true,\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\tdata: this.data.uuid,\n\t\t\t\toffset: this.offset,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t}\n\n\t}\n\n} );\n\n\nexport { InterleavedBufferAttribute };\n","import { Camera } from './Camera.js';\nimport { Object3D } from '../core/Object3D.js';\n\nfunction OrthographicCamera( left, right, top, bottom, near, far ) {\n\n\tCamera.call( this );\n\n\tthis.type = 'OrthographicCamera';\n\n\tthis.zoom = 1;\n\tthis.view = null;\n\n\tthis.left = ( left !== undefined ) ? left : - 1;\n\tthis.right = ( right !== undefined ) ? right : 1;\n\tthis.top = ( top !== undefined ) ? top : 1;\n\tthis.bottom = ( bottom !== undefined ) ? bottom : - 1;\n\n\tthis.near = ( near !== undefined ) ? near : 0.1;\n\tthis.far = ( far !== undefined ) ? far : 2000;\n\n\tthis.updateProjectionMatrix();\n\n}\n\nOrthographicCamera.prototype = Object.assign( Object.create( Camera.prototype ), {\n\n\tconstructor: OrthographicCamera,\n\n\tisOrthographicCamera: true,\n\n\tcopy: function ( source, recursive ) {\n\n\t\tCamera.prototype.copy.call( this, source, recursive );\n\n\t\tthis.left = source.left;\n\t\tthis.right = source.right;\n\t\tthis.top = source.top;\n\t\tthis.bottom = source.bottom;\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\n\t\tthis.zoom = source.zoom;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\treturn this;\n\n\t},\n\n\tsetViewOffset: function ( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t},\n\n\tclearViewOffset: function () {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t},\n\n\tupdateProjectionMatrix: function () {\n\n\t\tconst dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\tconst dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\tconst cx = ( this.right + this.left ) / 2;\n\t\tconst cy = ( this.top + this.bottom ) / 2;\n\n\t\tlet left = cx - dx;\n\t\tlet right = cx + dx;\n\t\tlet top = cy + dy;\n\t\tlet bottom = cy - dy;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\n\t\t\tconst scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\n\n\t\t\tleft += scaleW * this.view.offsetX;\n\t\t\tright = left + scaleW * this.view.width;\n\t\t\ttop -= scaleH * this.view.offsetY;\n\t\t\tbottom = top - scaleH * this.view.height;\n\n\t\t}\n\n\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\n\n\t\tthis.projectionMatrixInverse.getInverse( this.projectionMatrix );\n\n\t},\n\n\ttoJSON: function ( meta ) {\n\n\t\tconst data = Object3D.prototype.toJSON.call( this, meta );\n\n\t\tdata.object.zoom = this.zoom;\n\t\tdata.object.left = this.left;\n\t\tdata.object.right = this.right;\n\t\tdata.object.top = this.top;\n\t\tdata.object.bottom = this.bottom;\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\treturn data;\n\n\t}\n\n} );\n\n\nexport { OrthographicCamera };\n","import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  linewidth: <float>,\n *  linecap: \"round\",\n *  linejoin: \"round\"\n * }\n */\n\nfunction LineBasicMaterial( parameters ) {\n\n\tMaterial.call( this );\n\n\tthis.type = 'LineBasicMaterial';\n\n\tthis.color = new Color( 0xffffff );\n\n\tthis.linewidth = 1;\n\tthis.linecap = 'round';\n\tthis.linejoin = 'round';\n\n\tthis.morphTargets = false;\n\n\tthis.setValues( parameters );\n\n}\n\nLineBasicMaterial.prototype = Object.create( Material.prototype );\nLineBasicMaterial.prototype.constructor = LineBasicMaterial;\n\nLineBasicMaterial.prototype.isLineBasicMaterial = true;\n\nLineBasicMaterial.prototype.copy = function ( source ) {\n\n\tMaterial.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\n\tthis.linewidth = source.linewidth;\n\tthis.linecap = source.linecap;\n\tthis.linejoin = source.linejoin;\n\n\tthis.morphTargets = source.morphTargets;\n\n\treturn this;\n\n};\n\n\nexport { LineBasicMaterial };\n","import { TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  roughness: <float>,\n *  metalness: <float>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  roughnessMap: new THREE.Texture( <Image> ),\n *\n *  metalnessMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  envMapIntensity: <float>\n *\n *  refractionRatio: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  skinning: <bool>,\n *  morphTargets: <bool>,\n *  morphNormals: <bool>\n * }\n */\n\nfunction MeshStandardMaterial( parameters ) {\n\n\tMaterial.call( this );\n\n\tthis.defines = { 'STANDARD': '' };\n\n\tthis.type = 'MeshStandardMaterial';\n\n\tthis.color = new Color( 0xffffff ); // diffuse\n\tthis.roughness = 1.0;\n\tthis.metalness = 0.0;\n\n\tthis.map = null;\n\n\tthis.lightMap = null;\n\tthis.lightMapIntensity = 1.0;\n\n\tthis.aoMap = null;\n\tthis.aoMapIntensity = 1.0;\n\n\tthis.emissive = new Color( 0x000000 );\n\tthis.emissiveIntensity = 1.0;\n\tthis.emissiveMap = null;\n\n\tthis.bumpMap = null;\n\tthis.bumpScale = 1;\n\n\tthis.normalMap = null;\n\tthis.normalMapType = TangentSpaceNormalMap;\n\tthis.normalScale = new Vector2( 1, 1 );\n\n\tthis.displacementMap = null;\n\tthis.displacementScale = 1;\n\tthis.displacementBias = 0;\n\n\tthis.roughnessMap = null;\n\n\tthis.metalnessMap = null;\n\n\tthis.alphaMap = null;\n\n\tthis.envMap = null;\n\tthis.envMapIntensity = 1.0;\n\n\tthis.refractionRatio = 0.98;\n\n\tthis.wireframe = false;\n\tthis.wireframeLinewidth = 1;\n\tthis.wireframeLinecap = 'round';\n\tthis.wireframeLinejoin = 'round';\n\n\tthis.skinning = false;\n\tthis.morphTargets = false;\n\tthis.morphNormals = false;\n\n\tthis.vertexTangents = false;\n\n\tthis.setValues( parameters );\n\n}\n\nMeshStandardMaterial.prototype = Object.create( Material.prototype );\nMeshStandardMaterial.prototype.constructor = MeshStandardMaterial;\n\nMeshStandardMaterial.prototype.isMeshStandardMaterial = true;\n\nMeshStandardMaterial.prototype.copy = function ( source ) {\n\n\tMaterial.prototype.copy.call( this, source );\n\n\tthis.defines = { 'STANDARD': '' };\n\n\tthis.color.copy( source.color );\n\tthis.roughness = source.roughness;\n\tthis.metalness = source.metalness;\n\n\tthis.map = source.map;\n\n\tthis.lightMap = source.lightMap;\n\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\tthis.aoMap = source.aoMap;\n\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\tthis.emissive.copy( source.emissive );\n\tthis.emissiveMap = source.emissiveMap;\n\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\tthis.bumpMap = source.bumpMap;\n\tthis.bumpScale = source.bumpScale;\n\n\tthis.normalMap = source.normalMap;\n\tthis.normalMapType = source.normalMapType;\n\tthis.normalScale.copy( source.normalScale );\n\n\tthis.displacementMap = source.displacementMap;\n\tthis.displacementScale = source.displacementScale;\n\tthis.displacementBias = source.displacementBias;\n\n\tthis.roughnessMap = source.roughnessMap;\n\n\tthis.metalnessMap = source.metalnessMap;\n\n\tthis.alphaMap = source.alphaMap;\n\n\tthis.envMap = source.envMap;\n\tthis.envMapIntensity = source.envMapIntensity;\n\n\tthis.refractionRatio = source.refractionRatio;\n\n\tthis.wireframe = source.wireframe;\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\tthis.wireframeLinecap = source.wireframeLinecap;\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\tthis.skinning = source.skinning;\n\tthis.morphTargets = source.morphTargets;\n\tthis.morphNormals = source.morphNormals;\n\n\tthis.vertexTangents = source.vertexTangents;\n\n\treturn this;\n\n};\n\n\nexport { MeshStandardMaterial };\n","import { Vector2 } from '../math/Vector2.js';\nimport { MeshStandardMaterial } from './MeshStandardMaterial.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  clearcoat: <float>,\n *  clearcoatMap: new THREE.Texture( <Image> ),\n *  clearcoatRoughness: <float>,\n *  clearcoatRoughnessMap: new THREE.Texture( <Image> ),\n *  clearcoatNormalScale: <Vector2>,\n *  clearcoatNormalMap: new THREE.Texture( <Image> ),\n *\n *  reflectivity: <float>,\n *\n *  sheen: <Color>,\n *\n *  transmission: <float>,\n *  transmissionMap: new THREE.Texture( <Image> )\n * }\n */\n\nfunction MeshPhysicalMaterial( parameters ) {\n\n\tMeshStandardMaterial.call( this );\n\n\tthis.defines = {\n\n\t\t'STANDARD': '',\n\t\t'PHYSICAL': ''\n\n\t};\n\n\tthis.type = 'MeshPhysicalMaterial';\n\n\tthis.clearcoat = 0.0;\n\tthis.clearcoatMap = null;\n\tthis.clearcoatRoughness = 0.0;\n\tthis.clearcoatRoughnessMap = null;\n\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\n\tthis.clearcoatNormalMap = null;\n\n\tthis.reflectivity = 0.5; // maps to F0 = 0.04\n\n\tthis.sheen = null; // null will disable sheen bsdf\n\n\tthis.transmission = 0.0;\n\tthis.transmissionMap = null;\n\n\tthis.setValues( parameters );\n\n}\n\nMeshPhysicalMaterial.prototype = Object.create( MeshStandardMaterial.prototype );\nMeshPhysicalMaterial.prototype.constructor = MeshPhysicalMaterial;\n\nMeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = true;\n\nMeshPhysicalMaterial.prototype.copy = function ( source ) {\n\n\tMeshStandardMaterial.prototype.copy.call( this, source );\n\n\tthis.defines = {\n\n\t\t'STANDARD': '',\n\t\t'PHYSICAL': ''\n\n\t};\n\n\tthis.clearcoat = source.clearcoat;\n\tthis.clearcoatMap = source.clearcoatMap;\n\tthis.clearcoatRoughness = source.clearcoatRoughness;\n\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\n\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\n\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\n\n\tthis.reflectivity = source.reflectivity;\n\n\tif ( source.sheen ) {\n\n\t\tthis.sheen = ( this.sheen || new Color() ).copy( source.sheen );\n\n\t} else {\n\n\t\tthis.sheen = null;\n\n\t}\n\n\tthis.transmission = source.transmission;\n\tthis.transmissionMap = source.transmissionMap;\n\n\treturn this;\n\n};\n\nexport { MeshPhysicalMaterial };\n","import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  size: <float>,\n *  sizeAttenuation: <bool>\n *\n *  morphTargets: <bool>\n * }\n */\n\nfunction PointsMaterial( parameters ) {\n\n\tMaterial.call( this );\n\n\tthis.type = 'PointsMaterial';\n\n\tthis.color = new Color( 0xffffff );\n\n\tthis.map = null;\n\n\tthis.alphaMap = null;\n\n\tthis.size = 1;\n\tthis.sizeAttenuation = true;\n\n\tthis.morphTargets = false;\n\n\tthis.setValues( parameters );\n\n}\n\nPointsMaterial.prototype = Object.create( Material.prototype );\nPointsMaterial.prototype.constructor = PointsMaterial;\n\nPointsMaterial.prototype.isPointsMaterial = true;\n\nPointsMaterial.prototype.copy = function ( source ) {\n\n\tMaterial.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\n\tthis.map = source.map;\n\n\tthis.alphaMap = source.alphaMap;\n\n\tthis.size = source.size;\n\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\tthis.morphTargets = source.morphTargets;\n\n\treturn this;\n\n};\n\n\nexport { PointsMaterial };\n","import { Object3D } from '../core/Object3D.js';\n\nfunction Bone() {\n\n\tObject3D.call( this );\n\n\tthis.type = 'Bone';\n\n}\n\nBone.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: Bone,\n\n\tisBone: true\n\n} );\n\n\nexport { Bone };\n","import { Matrix4 } from '../math/Matrix4.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\nimport { Frustum } from '../math/Frustum.js';\n\nfunction LightShadow( camera ) {\n\n\tthis.camera = camera;\n\n\tthis.bias = 0;\n\tthis.normalBias = 0;\n\tthis.radius = 1;\n\n\tthis.mapSize = new Vector2( 512, 512 );\n\n\tthis.map = null;\n\tthis.mapPass = null;\n\tthis.matrix = new Matrix4();\n\n\tthis.autoUpdate = true;\n\tthis.needsUpdate = false;\n\n\tthis._frustum = new Frustum();\n\tthis._frameExtents = new Vector2( 1, 1 );\n\n\tthis._viewportCount = 1;\n\n\tthis._viewports = [\n\n\t\tnew Vector4( 0, 0, 1, 1 )\n\n\t];\n\n}\n\nObject.assign( LightShadow.prototype, {\n\n\t_projScreenMatrix: new Matrix4(),\n\n\t_lightPositionWorld: new Vector3(),\n\n\t_lookTarget: new Vector3(),\n\n\tgetViewportCount: function () {\n\n\t\treturn this._viewportCount;\n\n\t},\n\n\tgetFrustum: function () {\n\n\t\treturn this._frustum;\n\n\t},\n\n\tupdateMatrices: function ( light ) {\n\n\t\tconst shadowCamera = this.camera,\n\t\t\tshadowMatrix = this.matrix,\n\t\t\tprojScreenMatrix = this._projScreenMatrix,\n\t\t\tlookTarget = this._lookTarget,\n\t\t\tlightPositionWorld = this._lightPositionWorld;\n\n\t\tlightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tshadowCamera.position.copy( lightPositionWorld );\n\n\t\tlookTarget.setFromMatrixPosition( light.target.matrixWorld );\n\t\tshadowCamera.lookAt( lookTarget );\n\t\tshadowCamera.updateMatrixWorld();\n\n\t\tprojScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( projScreenMatrix );\n\n\t\tshadowMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\n\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\n\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\n\n\t},\n\n\tgetViewport: function ( viewportIndex ) {\n\n\t\treturn this._viewports[ viewportIndex ];\n\n\t},\n\n\tgetFrameExtents: function () {\n\n\t\treturn this._frameExtents;\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.camera = source.camera.clone();\n\n\t\tthis.bias = source.bias;\n\t\tthis.radius = source.radius;\n\n\t\tthis.mapSize.copy( source.mapSize );\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\ttoJSON: function () {\n\n\t\tconst object = {};\n\n\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\tif ( this.normalBias !== 0 ) object.normalBias = this.normalBias;\n\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\tdelete object.camera.matrix;\n\n\t\treturn object;\n\n\t}\n\n} );\n\n\nexport { LightShadow };\n","import { LightShadow } from './LightShadow.js';\nimport { OrthographicCamera } from '../cameras/OrthographicCamera.js';\n\nfunction DirectionalLightShadow() {\n\n\tLightShadow.call( this, new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\n\n}\n\nDirectionalLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\n\n\tconstructor: DirectionalLightShadow,\n\n\tisDirectionalLightShadow: true,\n\n\tupdateMatrices: function ( light ) {\n\n\t\tLightShadow.prototype.updateMatrices.call( this, light );\n\n\t}\n\n} );\n\n\nexport { DirectionalLightShadow };\n","import { Light } from './Light.js';\nimport { DirectionalLightShadow } from './DirectionalLightShadow.js';\nimport { Object3D } from '../core/Object3D.js';\n\nfunction DirectionalLight( color, intensity ) {\n\n\tLight.call( this, color, intensity );\n\n\tthis.type = 'DirectionalLight';\n\n\tthis.position.copy( Object3D.DefaultUp );\n\tthis.updateMatrix();\n\n\tthis.target = new Object3D();\n\n\tthis.shadow = new DirectionalLightShadow();\n\n}\n\nDirectionalLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\tconstructor: DirectionalLight,\n\n\tisDirectionalLight: true,\n\n\tcopy: function ( source ) {\n\n\t\tLight.prototype.copy.call( this, source );\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n} );\n\n\nexport { DirectionalLight };\n","import { LightShadow } from './LightShadow.js';\nimport { PerspectiveCamera } from '../cameras/PerspectiveCamera.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\n\nfunction PointLightShadow() {\n\n\tLightShadow.call( this, new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\tthis._frameExtents = new Vector2( 4, 2 );\n\n\tthis._viewportCount = 6;\n\n\tthis._viewports = [\n\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t// following orientation:\n\t\t//\n\t\t//  xzXZ\n\t\t//   y Y\n\t\t//\n\t\t// X - Positive x direction\n\t\t// x - Negative x direction\n\t\t// Y - Positive y direction\n\t\t// y - Negative y direction\n\t\t// Z - Positive z direction\n\t\t// z - Negative z direction\n\n\t\t// positive X\n\t\tnew Vector4( 2, 1, 1, 1 ),\n\t\t// negative X\n\t\tnew Vector4( 0, 1, 1, 1 ),\n\t\t// positive Z\n\t\tnew Vector4( 3, 1, 1, 1 ),\n\t\t// negative Z\n\t\tnew Vector4( 1, 1, 1, 1 ),\n\t\t// positive Y\n\t\tnew Vector4( 3, 0, 1, 1 ),\n\t\t// negative Y\n\t\tnew Vector4( 1, 0, 1, 1 )\n\t];\n\n\tthis._cubeDirections = [\n\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t];\n\n\tthis._cubeUps = [\n\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t];\n\n}\n\nPointLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\n\n\tconstructor: PointLightShadow,\n\n\tisPointLightShadow: true,\n\n\tupdateMatrices: function ( light, viewportIndex ) {\n\n\t\tif ( viewportIndex === undefined ) viewportIndex = 0;\n\n\t\tconst camera = this.camera,\n\t\t\tshadowMatrix = this.matrix,\n\t\t\tlightPositionWorld = this._lightPositionWorld,\n\t\t\tlookTarget = this._lookTarget,\n\t\t\tprojScreenMatrix = this._projScreenMatrix;\n\n\t\tlightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tcamera.position.copy( lightPositionWorld );\n\n\t\tlookTarget.copy( camera.position );\n\t\tlookTarget.add( this._cubeDirections[ viewportIndex ] );\n\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\n\t\tcamera.lookAt( lookTarget );\n\t\tcamera.updateMatrixWorld();\n\n\t\tshadowMatrix.makeTranslation( - lightPositionWorld.x, - lightPositionWorld.y, - lightPositionWorld.z );\n\n\t\tprojScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( projScreenMatrix );\n\n\t}\n\n} );\n\n\nexport { PointLightShadow };\n","import { Light } from './Light.js';\nimport { PointLightShadow } from './PointLightShadow.js';\n\nfunction PointLight( color, intensity, distance, decay ) {\n\n\tLight.call( this, color, intensity );\n\n\tthis.type = 'PointLight';\n\n\tObject.defineProperty( this, 'power', {\n\t\tget: function () {\n\n\t\t\t// intensity = power per solid angle.\n\t\t\t// ref: equation (15) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t\t\treturn this.intensity * 4 * Math.PI;\n\n\t\t},\n\t\tset: function ( power ) {\n\n\t\t\t// intensity = power per solid angle.\n\t\t\t// ref: equation (15) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t\t\tthis.intensity = power / ( 4 * Math.PI );\n\n\t\t}\n\t} );\n\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\n\n\tthis.shadow = new PointLightShadow();\n\n}\n\nPointLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\tconstructor: PointLight,\n\n\tisPointLight: true,\n\n\tcopy: function ( source ) {\n\n\t\tLight.prototype.copy.call( this, source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.decay = source.decay;\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n} );\n\n\nexport { PointLight };\n","import { LightShadow } from './LightShadow.js';\nimport { MathUtils } from '../math/MathUtils.js';\nimport { PerspectiveCamera } from '../cameras/PerspectiveCamera.js';\n\nfunction SpotLightShadow() {\n\n\tLightShadow.call( this, new PerspectiveCamera( 50, 1, 0.5, 500 ) );\n\n}\n\nSpotLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\n\n\tconstructor: SpotLightShadow,\n\n\tisSpotLightShadow: true,\n\n\tupdateMatrices: function ( light ) {\n\n\t\tconst camera = this.camera;\n\n\t\tconst fov = MathUtils.RAD2DEG * 2 * light.angle;\n\t\tconst aspect = this.mapSize.width / this.mapSize.height;\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\tLightShadow.prototype.updateMatrices.call( this, light );\n\n\t}\n\n} );\n\n\nexport { SpotLightShadow };\n","import { Light } from './Light.js';\nimport { SpotLightShadow } from './SpotLightShadow.js';\nimport { Object3D } from '../core/Object3D.js';\n\nfunction SpotLight( color, intensity, distance, angle, penumbra, decay ) {\n\n\tLight.call( this, color, intensity );\n\n\tthis.type = 'SpotLight';\n\n\tthis.position.copy( Object3D.DefaultUp );\n\tthis.updateMatrix();\n\n\tthis.target = new Object3D();\n\n\tObject.defineProperty( this, 'power', {\n\t\tget: function () {\n\n\t\t\t// intensity = power per solid angle.\n\t\t\t// ref: equation (17) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t\t\treturn this.intensity * Math.PI;\n\n\t\t},\n\t\tset: function ( power ) {\n\n\t\t\t// intensity = power per solid angle.\n\t\t\t// ref: equation (17) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t\t\tthis.intensity = power / Math.PI;\n\n\t\t}\n\t} );\n\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\n\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\n\tthis.penumbra = ( penumbra !== undefined ) ? penumbra : 0;\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\n\n\tthis.shadow = new SpotLightShadow();\n\n}\n\nSpotLight.prototype = Object.assign( Object.create( Light.prototype ), {\n\n\tconstructor: SpotLight,\n\n\tisSpotLight: true,\n\n\tcopy: function ( source ) {\n\n\t\tLight.prototype.copy.call( this, source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.angle = source.angle;\n\t\tthis.penumbra = source.penumbra;\n\t\tthis.decay = source.decay;\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n} );\n\n\nexport { SpotLight };\n","const Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\n\nexport { Cache };\n","function LoadingManager( onLoad, onProgress, onError ) {\n\n\tconst scope = this;\n\n\tlet isLoading = false;\n\tlet itemsLoaded = 0;\n\tlet itemsTotal = 0;\n\tlet urlModifier = undefined;\n\tconst handlers = [];\n\n\t// Refer to #5689 for the reason why we don't set .onStart\n\t// in the constructor\n\n\tthis.onStart = undefined;\n\tthis.onLoad = onLoad;\n\tthis.onProgress = onProgress;\n\tthis.onError = onError;\n\n\tthis.itemStart = function ( url ) {\n\n\t\titemsTotal ++;\n\n\t\tif ( isLoading === false ) {\n\n\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t}\n\n\t\tisLoading = true;\n\n\t};\n\n\tthis.itemEnd = function ( url ) {\n\n\t\titemsLoaded ++;\n\n\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t}\n\n\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\tisLoading = false;\n\n\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\tscope.onLoad();\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.itemError = function ( url ) {\n\n\t\tif ( scope.onError !== undefined ) {\n\n\t\t\tscope.onError( url );\n\n\t\t}\n\n\t};\n\n\tthis.resolveURL = function ( url ) {\n\n\t\tif ( urlModifier ) {\n\n\t\t\treturn urlModifier( url );\n\n\t\t}\n\n\t\treturn url;\n\n\t};\n\n\tthis.setURLModifier = function ( transform ) {\n\n\t\turlModifier = transform;\n\n\t\treturn this;\n\n\t};\n\n\tthis.addHandler = function ( regex, loader ) {\n\n\t\thandlers.push( regex, loader );\n\n\t\treturn this;\n\n\t};\n\n\tthis.removeHandler = function ( regex ) {\n\n\t\tconst index = handlers.indexOf( regex );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\thandlers.splice( index, 2 );\n\n\t\t}\n\n\t\treturn this;\n\n\t};\n\n\tthis.getHandler = function ( file ) {\n\n\t\tfor ( let i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\tconst regex = handlers[ i ];\n\t\t\tconst loader = handlers[ i + 1 ];\n\n\t\t\tif ( regex.global ) regex.lastIndex = 0; // see #17920\n\n\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\treturn loader;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t};\n\n}\n\nconst DefaultLoadingManager = new LoadingManager();\n\n\nexport { DefaultLoadingManager, LoadingManager };\n","import { DefaultLoadingManager } from './LoadingManager.js';\n\nfunction Loader( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\tthis.crossOrigin = 'anonymous';\n\tthis.path = '';\n\tthis.resourcePath = '';\n\tthis.requestHeader = {};\n\n}\n\nObject.assign( Loader.prototype, {\n\n\tload: function ( /* url, onLoad, onProgress, onError */ ) {},\n\n\tloadAsync: function ( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.load( url, resolve, onProgress, reject );\n\n\t\t} );\n\n\t},\n\n\tparse: function ( /* data */ ) {},\n\n\tsetCrossOrigin: function ( crossOrigin ) {\n\n\t\tthis.crossOrigin = crossOrigin;\n\t\treturn this;\n\n\t},\n\n\tsetPath: function ( path ) {\n\n\t\tthis.path = path;\n\t\treturn this;\n\n\t},\n\n\tsetResourcePath: function ( resourcePath ) {\n\n\t\tthis.resourcePath = resourcePath;\n\t\treturn this;\n\n\t},\n\n\tsetRequestHeader: function ( requestHeader ) {\n\n\t\tthis.requestHeader = requestHeader;\n\t\treturn this;\n\n\t}\n\n} );\n\nexport { Loader };\n","import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\n\nconst loading = {};\n\nfunction FileLoader( manager ) {\n\n\tLoader.call( this, manager );\n\n}\n\nFileLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: FileLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Check for data: URI\n\t\tconst dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\n\t\tconst dataUriRegexResult = url.match( dataUriRegex );\n\t\tlet request;\n\n\t\t// Safari can not handle Data URIs through XMLHttpRequest so process manually\n\t\tif ( dataUriRegexResult ) {\n\n\t\t\tconst mimeType = dataUriRegexResult[ 1 ];\n\t\t\tconst isBase64 = !! dataUriRegexResult[ 2 ];\n\n\t\t\tlet data = dataUriRegexResult[ 3 ];\n\t\t\tdata = decodeURIComponent( data );\n\n\t\t\tif ( isBase64 ) data = atob( data );\n\n\t\t\ttry {\n\n\t\t\t\tlet response;\n\t\t\t\tconst responseType = ( this.responseType || '' ).toLowerCase();\n\n\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\tconst view = new Uint8Array( data.length );\n\n\t\t\t\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\t\t\t\tview[ i ] = data.charCodeAt( i );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( responseType === 'blob' ) {\n\n\t\t\t\t\t\t\tresponse = new Blob( [ view.buffer ], { type: mimeType } );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tresponse = view.buffer;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\tresponse = parser.parseFromString( data, mimeType );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\tresponse = JSON.parse( data );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault: // 'text' or other\n\n\t\t\t\t\t\tresponse = data;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tif ( onLoad ) onLoad( response );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, 0 );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\n\t\t\t\t\tscope.manager.itemError( url );\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, 0 );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Initialise array for duplicate requests\n\n\t\t\tloading[ url ] = [];\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\trequest = new XMLHttpRequest();\n\n\t\t\trequest.open( 'GET', url, true );\n\n\t\t\trequest.addEventListener( 'load', function ( event ) {\n\n\t\t\t\tconst response = this.response;\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tif ( this.status === 200 || this.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( this.status === 0 ) console.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\n\t\t\t\t\t// error response bodies as proper responses to requests.\n\t\t\t\t\tCache.add( url, response );\n\n\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( response );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\tif ( callback.onError ) callback.onError( event );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.manager.itemError( url );\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}\n\n\t\t\t}, false );\n\n\t\t\trequest.addEventListener( 'progress', function ( event ) {\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t}\n\n\t\t\t}, false );\n\n\t\t\trequest.addEventListener( 'error', function ( event ) {\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( event );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, false );\n\n\t\t\trequest.addEventListener( 'abort', function ( event ) {\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( event );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, false );\n\n\t\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\n\t\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\n\n\t\t\tif ( request.overrideMimeType ) request.overrideMimeType( this.mimeType !== undefined ? this.mimeType : 'text/plain' );\n\n\t\t\tfor ( const header in this.requestHeader ) {\n\n\t\t\t\trequest.setRequestHeader( header, this.requestHeader[ header ] );\n\n\t\t\t}\n\n\t\t\trequest.send( null );\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\treturn request;\n\n\t},\n\n\tsetResponseType: function ( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t},\n\n\tsetWithCredentials: function ( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t},\n\n\tsetMimeType: function ( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t}\n\n} );\n\n\nexport { FileLoader };\n","import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\n\nfunction ImageBitmapLoader( manager ) {\n\n\tif ( typeof createImageBitmap === 'undefined' ) {\n\n\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\n\n\t}\n\n\tif ( typeof fetch === 'undefined' ) {\n\n\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\n\n\t}\n\n\tLoader.call( this, manager );\n\n\tthis.options = { premultiplyAlpha: 'none' };\n\n}\n\nImageBitmapLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: ImageBitmapLoader,\n\n\tisImageBitmapLoader: true,\n\n\tsetOptions: function setOptions( options ) {\n\n\t\tthis.options = options;\n\n\t\treturn this;\n\n\t},\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tfetch( url ).then( function ( res ) {\n\n\t\t\treturn res.blob();\n\n\t\t} ).then( function ( blob ) {\n\n\t\t\treturn createImageBitmap( blob, scope.options );\n\n\t\t} ).then( function ( imageBitmap ) {\n\n\t\t\tCache.add( url, imageBitmap );\n\n\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} ).catch( function ( e ) {\n\n\t\t\tif ( onError ) onError( e );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} );\n\n\t\tscope.manager.itemStart( url );\n\n\t}\n\n} );\n\nexport { ImageBitmapLoader };\n","const LoaderUtils = {\n\n\tdecodeText: function ( array ) {\n\n\t\tif ( typeof TextDecoder !== 'undefined' ) {\n\n\t\t\treturn new TextDecoder().decode( array );\n\n\t\t}\n\n\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\n\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\n\n\t\tlet s = '';\n\n\t\tfor ( let i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t// Implicitly assumes little-endian.\n\t\t\ts += String.fromCharCode( array[ i ] );\n\n\t\t}\n\n\t\ttry {\n\n\t\t\t// merges multi-byte utf-8 characters.\n\n\t\t\treturn decodeURIComponent( escape( s ) );\n\n\t\t} catch ( e ) { // see #16358\n\n\t\t\treturn s;\n\n\t\t}\n\n\t},\n\n\textractUrlBase: function ( url ) {\n\n\t\tconst index = url.lastIndexOf( '/' );\n\n\t\tif ( index === - 1 ) return './';\n\n\t\treturn url.substr( 0, index + 1 );\n\n\t}\n\n};\n\nexport { LoaderUtils };\n","import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\n\nfunction ImageLoader( manager ) {\n\n\tLoader.call( this, manager );\n\n}\n\nImageLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: ImageLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst image = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'img' );\n\n\t\tfunction onImageLoad() {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t\tCache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction onImageError( event ) {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\timage.addEventListener( 'load', onImageLoad, false );\n\t\timage.addEventListener( 'error', onImageError, false );\n\n\t\tif ( url.substr( 0, 5 ) !== 'data:' ) {\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t}\n\n} );\n\n\nexport { ImageLoader };\n","import { RGBAFormat, RGBFormat } from '../constants.js';\nimport { ImageLoader } from './ImageLoader.js';\nimport { Texture } from '../textures/Texture.js';\nimport { Loader } from './Loader.js';\n\nfunction TextureLoader( manager ) {\n\n\tLoader.call( this, manager );\n\n}\n\nTextureLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: TextureLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new Texture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\n\t\t\t// JPEGs can't have an alpha channel, so memory can be saved by storing them as RGB.\n\t\t\tconst isJPEG = url.search( /\\.jpe?g($|\\?)/i ) > 0 || url.search( /^data\\:image\\/jpeg/ ) === 0;\n\n\t\t\ttexture.format = isJPEG ? RGBFormat : RGBAFormat;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\treturn texture;\n\n\t}\n\n} );\n\n\nexport { TextureLoader };\n","import { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { LineBasicMaterial } from '../materials/LineBasicMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\n\nconst _start = new Vector3();\nconst _end = new Vector3();\nconst _inverseMatrix = new Matrix4();\nconst _ray = new Ray();\nconst _sphere = new Sphere();\n\nfunction Line( geometry, material, mode ) {\n\n\tif ( mode === 1 ) {\n\n\t\tconsole.error( 'THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.' );\n\n\t}\n\n\tObject3D.call( this );\n\n\tthis.type = 'Line';\n\n\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\n\tthis.material = material !== undefined ? material : new LineBasicMaterial();\n\n\tthis.updateMorphTargets();\n\n}\n\nLine.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: Line,\n\n\tisLine: true,\n\n\tcopy: function ( source ) {\n\n\t\tObject3D.prototype.copy.call( this, source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t},\n\n\tcomputeLineDistances: function () {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [ 0 ];\n\n\t\t\t\tfor ( let i = 1, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i - 1 );\n\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i ] += _start.distanceTo( _end );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconst vertices = geometry.vertices;\n\t\t\tconst lineDistances = geometry.lineDistances;\n\n\t\t\tlineDistances[ 0 ] = 0;\n\n\t\t\tfor ( let i = 1, l = vertices.length; i < l; i ++ ) {\n\n\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i ] += vertices[ i - 1 ].distanceTo( vertices[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\traycast: function ( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Line.threshold;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.getInverse( matrixWorld );\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst vStart = new Vector3();\n\t\tconst vEnd = new Vector3();\n\t\tconst interSegment = new Vector3();\n\t\tconst interRay = new Vector3();\n\t\tconst step = ( this && this.isLineSegments ) ? 2 : 1;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positions = attributes.position.array;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst indices = index.array;\n\n\t\t\t\tfor ( let i = 0, l = indices.length - 1; i < l; i += step ) {\n\n\t\t\t\t\tconst a = indices[ i ];\n\t\t\t\t\tconst b = indices[ i + 1 ];\n\n\t\t\t\t\tvStart.fromArray( positions, a * 3 );\n\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\n\n\t\t\t\t\tconst distSq = _ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( let i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\n\n\t\t\t\t\tvStart.fromArray( positions, 3 * i );\n\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\n\n\t\t\t\t\tconst distSq = _ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconst vertices = geometry.vertices;\n\t\t\tconst nbVertices = vertices.length;\n\n\t\t\tfor ( let i = 0; i < nbVertices - 1; i += step ) {\n\n\t\t\t\tconst distSq = _ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\n\n\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\tintersects.push( {\n\n\t\t\t\t\tdistance: distance,\n\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\tindex: i,\n\t\t\t\t\tface: null,\n\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\tobject: this\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tupdateMorphTargets: function () {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n} );\n\n\nexport { Line };\n","import { Line } from './Line.js';\n\nfunction LineLoop( geometry, material ) {\n\n\tLine.call( this, geometry, material );\n\n\tthis.type = 'LineLoop';\n\n}\n\nLineLoop.prototype = Object.assign( Object.create( Line.prototype ), {\n\n\tconstructor: LineLoop,\n\n\tisLineLoop: true,\n\n} );\n\n\nexport { LineLoop };\n","import { Line } from './Line.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\n\nconst _start = new Vector3();\nconst _end = new Vector3();\n\nfunction LineSegments( geometry, material ) {\n\n\tLine.call( this, geometry, material );\n\n\tthis.type = 'LineSegments';\n\n}\n\nLineSegments.prototype = Object.assign( Object.create( Line.prototype ), {\n\n\tconstructor: LineSegments,\n\n\tisLineSegments: true,\n\n\tcomputeLineDistances: function () {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [];\n\n\t\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i += 2 ) {\n\n\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconst vertices = geometry.vertices;\n\t\t\tconst lineDistances = geometry.lineDistances;\n\n\t\t\tfor ( let i = 0, l = vertices.length; i < l; i += 2 ) {\n\n\t\t\t\t_start.copy( vertices[ i ] );\n\t\t\t\t_end.copy( vertices[ i + 1 ] );\n\n\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n} );\n\n\nexport { LineSegments };\n","import { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { PointsMaterial } from '../materials/PointsMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\n\nconst _inverseMatrix = new Matrix4();\nconst _ray = new Ray();\nconst _sphere = new Sphere();\nconst _position = new Vector3();\n\nfunction Points( geometry, material ) {\n\n\tObject3D.call( this );\n\n\tthis.type = 'Points';\n\n\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\n\tthis.material = material !== undefined ? material : new PointsMaterial();\n\n\tthis.updateMorphTargets();\n\n}\n\nPoints.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: Points,\n\n\tisPoints: true,\n\n\tcopy: function ( source ) {\n\n\t\tObject3D.prototype.copy.call( this, source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t},\n\n\traycast: function ( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Points.threshold;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.getInverse( matrixWorld );\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positions = attributes.position.array;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst indices = index.array;\n\n\t\t\t\tfor ( let i = 0, il = indices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst a = indices[ i ];\n\n\t\t\t\t\t_position.fromArray( positions, a * 3 );\n\n\t\t\t\t\ttestPoint( _position, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( let i = 0, l = positions.length / 3; i < l; i ++ ) {\n\n\t\t\t\t\t_position.fromArray( positions, i * 3 );\n\n\t\t\t\t\ttestPoint( _position, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst vertices = geometry.vertices;\n\n\t\t\tfor ( let i = 0, l = vertices.length; i < l; i ++ ) {\n\n\t\t\t\ttestPoint( vertices[ i ], i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tupdateMorphTargets: function () {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n} );\n\nfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\n\n\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\n\n\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\tconst intersectPoint = new Vector3();\n\n\t\t_ray.closestPointToPoint( point, intersectPoint );\n\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\tpoint: intersectPoint,\n\t\t\tindex: index,\n\t\t\tface: null,\n\t\t\tobject: object\n\n\t\t} );\n\n\t}\n\n}\n\nexport { Points };\n","import { Matrix4 } from '../math/Matrix4.js';\n\nconst _offsetMatrix = new Matrix4();\nconst _identityMatrix = new Matrix4();\n\nfunction Skeleton( bones, boneInverses ) {\n\n\t// copy the bone array\n\n\tbones = bones || [];\n\n\tthis.bones = bones.slice( 0 );\n\tthis.boneMatrices = new Float32Array( this.bones.length * 16 );\n\n\tthis.frame = - 1;\n\n\t// use the supplied bone inverses or calculate the inverses\n\n\tif ( boneInverses === undefined ) {\n\n\t\tthis.calculateInverses();\n\n\t} else {\n\n\t\tif ( this.bones.length === boneInverses.length ) {\n\n\t\t\tthis.boneInverses = boneInverses.slice( 0 );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Skeleton boneInverses is the wrong length.' );\n\n\t\t\tthis.boneInverses = [];\n\n\t\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nObject.assign( Skeleton.prototype, {\n\n\tcalculateInverses: function () {\n\n\t\tthis.boneInverses = [];\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst inverse = new Matrix4();\n\n\t\t\tif ( this.bones[ i ] ) {\n\n\t\t\t\tinverse.getInverse( this.bones[ i ].matrixWorld );\n\n\t\t\t}\n\n\t\t\tthis.boneInverses.push( inverse );\n\n\t\t}\n\n\t},\n\n\tpose: function () {\n\n\t\t// recover the bind-time world matrices\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// compute the local matrices, positions, rotations and scales\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tupdate: function () {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\t\tconst boneMatrices = this.boneMatrices;\n\t\tconst boneTexture = this.boneTexture;\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( let i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tconst matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\n\n\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\n\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\n\n\t\t}\n\n\t\tif ( boneTexture !== undefined ) {\n\n\t\t\tboneTexture.needsUpdate = true;\n\n\t\t}\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new Skeleton( this.bones, this.boneInverses );\n\n\t},\n\n\tgetBoneByName: function ( name ) {\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone.name === name ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t},\n\n\tdispose: function ( ) {\n\n\t\tif ( this.boneTexture ) {\n\n\t\t\tthis.boneTexture.dispose();\n\n\t\t\tthis.boneTexture = undefined;\n\n\t\t}\n\n\t}\n\n} );\n\n\nexport { Skeleton };\n","import { Mesh } from './Mesh.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\n\nfunction SkinnedMesh( geometry, material ) {\n\n\tif ( geometry && geometry.isGeometry ) {\n\n\t\tconsole.error( 'THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t}\n\n\tMesh.call( this, geometry, material );\n\n\tthis.type = 'SkinnedMesh';\n\n\tthis.bindMode = 'attached';\n\tthis.bindMatrix = new Matrix4();\n\tthis.bindMatrixInverse = new Matrix4();\n\n}\n\nSkinnedMesh.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n\tconstructor: SkinnedMesh,\n\n\tisSkinnedMesh: true,\n\n\tcopy: function ( source ) {\n\n\t\tMesh.prototype.copy.call( this, source );\n\n\t\tthis.bindMode = source.bindMode;\n\t\tthis.bindMatrix.copy( source.bindMatrix );\n\t\tthis.bindMatrixInverse.copy( source.bindMatrixInverse );\n\n\t\tthis.skeleton = source.skeleton;\n\n\t\treturn this;\n\n\t},\n\n\tbind: function ( skeleton, bindMatrix ) {\n\n\t\tthis.skeleton = skeleton;\n\n\t\tif ( bindMatrix === undefined ) {\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t}\n\n\t\tthis.bindMatrix.copy( bindMatrix );\n\t\tthis.bindMatrixInverse.getInverse( bindMatrix );\n\n\t},\n\n\tpose: function () {\n\n\t\tthis.skeleton.pose();\n\n\t},\n\n\tnormalizeSkinWeights: function () {\n\n\t\tconst vector = new Vector4();\n\n\t\tconst skinWeight = this.geometry.attributes.skinWeight;\n\n\t\tfor ( let i = 0, l = skinWeight.count; i < l; i ++ ) {\n\n\t\t\tvector.x = skinWeight.getX( i );\n\t\t\tvector.y = skinWeight.getY( i );\n\t\t\tvector.z = skinWeight.getZ( i );\n\t\t\tvector.w = skinWeight.getW( i );\n\n\t\t\tconst scale = 1.0 / vector.manhattanLength();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tvector.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t}\n\n\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n\n\t\t}\n\n\t},\n\n\tupdateMatrixWorld: function ( force ) {\n\n\t\tMesh.prototype.updateMatrixWorld.call( this, force );\n\n\t\tif ( this.bindMode === 'attached' ) {\n\n\t\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\n\n\t\t} else if ( this.bindMode === 'detached' ) {\n\n\t\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\n\n\t\t}\n\n\t},\n\n\tboneTransform: ( function () {\n\n\t\tconst basePosition = new Vector3();\n\n\t\tconst skinIndex = new Vector4();\n\t\tconst skinWeight = new Vector4();\n\n\t\tconst vector = new Vector3();\n\t\tconst matrix = new Matrix4();\n\n\t\treturn function ( index, target ) {\n\n\t\t\tconst skeleton = this.skeleton;\n\t\t\tconst geometry = this.geometry;\n\n\t\t\tskinIndex.fromBufferAttribute( geometry.attributes.skinIndex, index );\n\t\t\tskinWeight.fromBufferAttribute( geometry.attributes.skinWeight, index );\n\n\t\t\tbasePosition.fromBufferAttribute( geometry.attributes.position, index ).applyMatrix4( this.bindMatrix );\n\n\t\t\ttarget.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\t\tconst weight = skinWeight.getComponent( i );\n\n\t\t\t\tif ( weight !== 0 ) {\n\n\t\t\t\t\tconst boneIndex = skinIndex.getComponent( i );\n\n\t\t\t\t\tmatrix.multiplyMatrices( skeleton.bones[ boneIndex ].matrixWorld, skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\t\ttarget.addScaledVector( vector.copy( basePosition ).applyMatrix4( matrix ), weight );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn target.applyMatrix4( this.bindMatrixInverse );\n\n\t\t};\n\n\t}() )\n\n} );\n\n\nexport { SkinnedMesh };\n","import { Texture } from './Texture.js';\n\nfunction CanvasTexture( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\tTexture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\tthis.needsUpdate = true;\n\n}\n\nCanvasTexture.prototype = Object.create( Texture.prototype );\nCanvasTexture.prototype.constructor = CanvasTexture;\nCanvasTexture.prototype.isCanvasTexture = true;\n\nexport { CanvasTexture };\n","/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nimport {\n  ClampToEdgeWrapping,\n  DoubleSide,\n  FrontSide,\n  InterpolateDiscrete,\n  InterpolateLinear,\n  LinearFilter,\n  LinearMipmapLinearFilter,\n  LinearMipmapNearestFilter,\n  MirroredRepeatWrapping,\n  NearestFilter,\n  NearestMipmapLinearFilter,\n  NearestMipmapNearestFilter,\n  RepeatWrapping,\n  RGBAFormat,\n  RGBFormat,\n  sRGBEncoding,\n  TangentSpaceNormalMap,\n  TriangleFanDrawMode,\n  TriangleStripDrawMode,\n} from 'three/src/constants.js'\n\nimport { BufferAttribute } from 'three/src/core/BufferAttribute.js'\nimport { BufferGeometry } from 'three/src/core/BufferGeometry.js'\nimport { InterleavedBuffer } from 'three/src/core/InterleavedBuffer.js'\nimport { InterleavedBufferAttribute } from 'three/src/core/InterleavedBufferAttribute.js'\nimport { Object3D } from 'three/src/core/Object3D.js'\n\nimport { AnimationClip } from 'three/src/animation/AnimationClip.js'\nimport { PropertyBinding } from 'three/src/animation/PropertyBinding.js'\n\nimport { QuaternionKeyframeTrack } from 'three/src/animation/tracks/QuaternionKeyframeTrack.js'\nimport { VectorKeyframeTrack } from 'three/src/animation/tracks/VectorKeyframeTrack.js'\nimport { NumberKeyframeTrack } from 'three/src/animation/tracks/NumberKeyframeTrack.js'\n\nimport { OrthographicCamera } from 'three/src/cameras/OrthographicCamera.js'\nimport { PerspectiveCamera } from 'three/src/cameras/PerspectiveCamera.js'\n\nimport { LineBasicMaterial } from 'three/src/materials/LineBasicMaterial.js'\nimport { Material } from 'three/src/materials/Material.js'\nimport { MeshBasicMaterial } from 'three/src/materials/MeshBasicMaterial.js'\nimport { MeshPhysicalMaterial } from 'three/src/materials/MeshPhysicalMaterial.js'\nimport { MeshStandardMaterial } from 'three/src/materials/MeshStandardMaterial.js'\nimport { PointsMaterial } from 'three/src/materials/PointsMaterial.js'\n\nimport { Box3 } from 'three/src/math/Box3.js'\nimport { Color } from 'three/src/math/Color.js'\nimport { Interpolant } from 'three/src/math/Interpolant.js'\nimport { MathUtils } from 'three/src/math/MathUtils.js'\nimport { Matrix4 } from 'three/src/math/Matrix4.js'\nimport { Sphere } from 'three/src/math/Sphere.js'\nimport { Vector2 } from 'three/src/math/Vector2.js'\nimport { Vector3 } from 'three/src/math/Vector3.js'\n\nimport { Bone } from 'three/src/objects/Bone.js'\nimport { Group } from 'three/src/objects/Group.js'\n\nimport { DirectionalLight } from 'three/src/lights/DirectionalLight.js'\nimport { PointLight } from 'three/src/lights/PointLight.js'\nimport { SpotLight } from 'three/src/lights/SpotLight.js'\n\nimport { FileLoader } from 'three/src/loaders/FileLoader.js'\nimport { ImageBitmapLoader } from 'three/src/loaders/ImageBitmapLoader.js'\nimport { Loader } from 'three/src/loaders/Loader.js'\nimport { LoaderUtils } from 'three/src/loaders/LoaderUtils.js'\nimport { TextureLoader } from 'three/src/loaders/TextureLoader.js'\n\nimport { Line } from 'three/src/objects/Line.js'\nimport { LineLoop } from 'three/src/objects/LineLoop.js'\nimport { LineSegments } from 'three/src/objects/LineSegments.js'\nimport { Mesh } from 'three/src/objects/Mesh.js'\nimport { Points } from 'three/src/objects/Points.js'\nimport { Skeleton } from 'three/src/objects/Skeleton.js'\nimport { SkinnedMesh } from 'three/src/objects/SkinnedMesh.js'\n\nimport { CanvasTexture } from 'three/src/textures/CanvasTexture.js'\n\nconst GLTFLoader = (function () {\n  function GLTFLoader(manager) {\n    Loader.call(this, manager)\n\n    this.dracoLoader = null\n    this.ddsLoader = null\n\n    this.pluginCallbacks = []\n    this.register(function (parser) {\n      return new GLTFMaterialsClearcoatExtension(parser)\n    })\n  }\n\n  GLTFLoader.prototype = Object.assign(Object.create(Loader.prototype), {\n    constructor: GLTFLoader,\n\n    load: function (url, onLoad, onProgress, onError) {\n      const scope = this\n\n      let resourcePath\n\n      if (this.resourcePath !== '') {\n        resourcePath = this.resourcePath\n      } else if (this.path !== '') {\n        resourcePath = this.path\n      } else {\n        resourcePath = LoaderUtils.extractUrlBase(url)\n      }\n\n      // Tells the LoadingManager to track an extra item, which resolves after\n      // the model is fully loaded. This means the count of items loaded will\n      // be incorrect, but ensures manager.onLoad() does not fire early.\n      scope.manager.itemStart(url)\n\n      const _onError = e => {\n        if (onError) {\n          onError(e)\n        } else {\n          console.error(e)\n        }\n\n        scope.manager.itemError(url)\n        scope.manager.itemEnd(url)\n      }\n\n      const loader = new FileLoader(scope.manager)\n\n      loader.setPath(this.path)\n      loader.setResponseType('arraybuffer')\n      loader.setRequestHeader(this.requestHeader)\n\n      if (scope.crossOrigin === 'use-credentials') {\n        loader.setWithCredentials(true)\n      }\n\n      loader.load(\n        url,\n        function (data) {\n          try {\n            scope.parse(\n              data,\n              resourcePath,\n              function (gltf) {\n                onLoad(gltf)\n\n                scope.manager.itemEnd(url)\n              },\n              _onError,\n            )\n          } catch (e) {\n            _onError(e)\n          }\n        },\n        onProgress,\n        _onError,\n      )\n    },\n\n    setDRACOLoader(dracoLoader) {\n      this.dracoLoader = dracoLoader\n      return this\n    },\n\n    setDDSLoader(ddsLoader) {\n      this.ddsLoader = ddsLoader\n      return this\n    },\n\n    register(callback) {\n      if (this.pluginCallbacks.indexOf(callback) === -1) {\n        this.pluginCallbacks.push(callback)\n      }\n\n      return this\n    },\n\n    unregister(callback) {\n      if (this.pluginCallbacks.indexOf(callback) !== -1) {\n        this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(callback), 1)\n      }\n\n      return this\n    },\n\n    parse(data, path, onLoad, onError) {\n      let content\n      const extensions = {}\n      const plugins = {}\n\n      if (typeof data === 'string') {\n        content = data\n      } else {\n        const magic = LoaderUtils.decodeText(new Uint8Array(data, 0, 4))\n\n        if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\n          try {\n            extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data)\n          } catch (error) {\n            if (onError) onError(error)\n            return\n          }\n\n          content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content\n        } else {\n          content = LoaderUtils.decodeText(new Uint8Array(data))\n        }\n      }\n\n      const json = JSON.parse(content)\n\n      if (json.asset === undefined || json.asset.version[0] < 2) {\n        if (onError)\n          onError(\n            new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.'),\n          )\n        return\n      }\n\n      const parser = new GLTFParser(json, {\n        path: path || this.resourcePath || '',\n        crossOrigin: this.crossOrigin,\n        manager: this.manager,\n      })\n\n      parser.fileLoader.setRequestHeader(this.requestHeader)\n\n      for (let i = 0; i < this.pluginCallbacks.length; i++) {\n        const plugin = this.pluginCallbacks[i](parser)\n        plugins[plugin.name] = plugin\n\n        // Workaround to avoid determining as unknown extension\n        // in addUnknownExtensionsToUserData().\n        // Remove this workaround if we move all the existing\n        // extension handlers to plugin system\n        extensions[plugin.name] = true\n      }\n\n      if (json.extensionsUsed) {\n        for (let i = 0; i < json.extensionsUsed.length; ++i) {\n          const extensionName = json.extensionsUsed[i]\n          const extensionsRequired = json.extensionsRequired || []\n\n          switch (extensionName) {\n            case EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n              extensions[extensionName] = new GLTFLightsExtension(json)\n              break\n\n            case EXTENSIONS.KHR_MATERIALS_UNLIT:\n              extensions[extensionName] = new GLTFMaterialsUnlitExtension()\n              break\n\n            case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n              extensions[extensionName] = new GLTFMaterialsPbrSpecularGlossinessExtension()\n              break\n\n            case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n              extensions[extensionName] = new GLTFDracoMeshCompressionExtension(\n                json,\n                this.dracoLoader,\n              )\n              break\n\n            case EXTENSIONS.MSFT_TEXTURE_DDS:\n              extensions[extensionName] = new GLTFTextureDDSExtension(this.ddsLoader)\n              break\n\n            case EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n              extensions[extensionName] = new GLTFTextureTransformExtension()\n              break\n\n            case EXTENSIONS.KHR_MESH_QUANTIZATION:\n              extensions[extensionName] = new GLTFMeshQuantizationExtension()\n              break\n\n            default:\n              if (\n                extensionsRequired.indexOf(extensionName) >= 0 &&\n                plugins[extensionName] === undefined\n              ) {\n                console.warn('THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".')\n              }\n          }\n        }\n      }\n\n      parser.setExtensions(extensions)\n      parser.setPlugins(plugins)\n      parser.parse(onLoad, onError)\n    },\n  })\n\n  /* GLTFREGISTRY */\n\n  function GLTFRegistry() {\n    let objects = {}\n\n    return {\n      get(key) {\n        return objects[key]\n      },\n\n      add(key, object) {\n        objects[key] = object\n      },\n\n      remove(key) {\n        delete objects[key]\n      },\n\n      removeAll() {\n        objects = {}\n      },\n    }\n  }\n\n  /*********************************/\n  /********** EXTENSIONS ***********/\n  /*********************************/\n\n  const EXTENSIONS = {\n    KHR_BINARY_GLTF: 'KHR_binary_glTF',\n    KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n    KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n    KHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n    KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n    KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n    KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n    KHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n    MSFT_TEXTURE_DDS: 'MSFT_texture_dds',\n  }\n\n  /**\n   * DDS Texture Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n   *\n   */\n  function GLTFTextureDDSExtension(ddsLoader) {\n    if (!ddsLoader) {\n      throw new Error(\n        'THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader',\n      )\n    }\n\n    this.name = EXTENSIONS.MSFT_TEXTURE_DDS\n    this.ddsLoader = ddsLoader\n  }\n\n  /**\n   * Punctual Lights Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n   */\n  function GLTFLightsExtension(json) {\n    this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL\n\n    const extension = (json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL]) || {}\n    this.lightDefs = extension.lights || []\n  }\n\n  GLTFLightsExtension.prototype.loadLight = function (lightIndex) {\n    const lightDef = this.lightDefs[lightIndex]\n    let lightNode\n\n    const color = new Color(0xffffff)\n    if (lightDef.color !== undefined) color.fromArray(lightDef.color)\n\n    const range = lightDef.range !== undefined ? lightDef.range : 0\n\n    switch (lightDef.type) {\n      case 'directional':\n        lightNode = new DirectionalLight(color)\n        lightNode.target.position.set(0, 0, -1)\n        lightNode.add(lightNode.target)\n        break\n\n      case 'point':\n        lightNode = new PointLight(color)\n        lightNode.distance = range\n        break\n\n      case 'spot':\n        lightNode = new SpotLight(color)\n        lightNode.distance = range\n        // Handle spotlight properties.\n        lightDef.spot = lightDef.spot || {}\n        lightDef.spot.innerConeAngle =\n          lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0\n        lightDef.spot.outerConeAngle =\n          lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0\n        lightNode.angle = lightDef.spot.outerConeAngle\n        lightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle\n        lightNode.target.position.set(0, 0, -1)\n        lightNode.add(lightNode.target)\n        break\n\n      default:\n        throw new Error('THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".')\n    }\n\n    // Some lights (e.g. spot) default to a position other than the origin. Reset the position\n    // here, because node-level parsing will only override position if explicitly specified.\n    lightNode.position.set(0, 0, 0)\n\n    lightNode.decay = 2\n\n    if (lightDef.intensity !== undefined) lightNode.intensity = lightDef.intensity\n\n    lightNode.name = lightDef.name || 'light_' + lightIndex\n\n    return Promise.resolve(lightNode)\n  }\n\n  /**\n   * Unlit Materials Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n   */\n  function GLTFMaterialsUnlitExtension() {\n    this.name = EXTENSIONS.KHR_MATERIALS_UNLIT\n  }\n\n  GLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n    return MeshBasicMaterial\n  }\n\n  GLTFMaterialsUnlitExtension.prototype.extendParams = function (\n    materialParams,\n    materialDef,\n    parser,\n  ) {\n    const pending = []\n\n    materialParams.color = new Color(1.0, 1.0, 1.0)\n    materialParams.opacity = 1.0\n\n    const metallicRoughness = materialDef.pbrMetallicRoughness\n\n    if (metallicRoughness) {\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        const array = metallicRoughness.baseColorFactor\n\n        materialParams.color.fromArray(array)\n        materialParams.opacity = array[3]\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture),\n        )\n      }\n    }\n\n    return Promise.all(pending)\n  }\n\n  /**\n   * Clearcoat Materials Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n   */\n  function GLTFMaterialsClearcoatExtension(parser) {\n    this.parser = parser\n    this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT\n  }\n\n  GLTFMaterialsClearcoatExtension.prototype.getMaterialType = function (/* materialIndex */) {\n    return MeshPhysicalMaterial\n  }\n\n  GLTFMaterialsClearcoatExtension.prototype.extendMaterialParams = function (\n    materialIndex,\n    materialParams,\n  ) {\n    const parser = this.parser\n    const materialDef = parser.json.materials[materialIndex]\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return Promise.resolve()\n    }\n\n    const pending = []\n\n    const extension = materialDef.extensions[this.name]\n\n    if (extension.clearcoatFactor !== undefined) {\n      materialParams.clearcoat = extension.clearcoatFactor\n    }\n\n    if (extension.clearcoatTexture !== undefined) {\n      pending.push(parser.assignTexture(materialParams, 'clearcoatMap', extension.clearcoatTexture))\n    }\n\n    if (extension.clearcoatRoughnessFactor !== undefined) {\n      materialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor\n    }\n\n    if (extension.clearcoatRoughnessTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatRoughnessMap',\n          extension.clearcoatRoughnessTexture,\n        ),\n      )\n    }\n\n    if (extension.clearcoatNormalTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatNormalMap',\n          extension.clearcoatNormalTexture,\n        ),\n      )\n\n      if (extension.clearcoatNormalTexture.scale !== undefined) {\n        const scale = extension.clearcoatNormalTexture.scale\n\n        materialParams.clearcoatNormalScale = new Vector2(scale, scale)\n      }\n    }\n\n    return Promise.all(pending)\n  }\n\n  /* BINARY EXTENSION */\n  const BINARY_EXTENSION_HEADER_MAGIC = 'glTF'\n  const BINARY_EXTENSION_HEADER_LENGTH = 12\n  const BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4e4f534a, BIN: 0x004e4942 }\n\n  function GLTFBinaryExtension(data) {\n    this.name = EXTENSIONS.KHR_BINARY_GLTF\n    this.content = null\n    this.body = null\n\n    const headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH)\n\n    this.header = {\n      magic: LoaderUtils.decodeText(new Uint8Array(data.slice(0, 4))),\n      version: headerView.getUint32(4, true),\n      length: headerView.getUint32(8, true),\n    }\n\n    if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\n      throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.')\n    } else if (this.header.version < 2.0) {\n      throw new Error('THREE.GLTFLoader: Legacy binary file detected.')\n    }\n\n    const chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH)\n    let chunkIndex = 0\n\n    while (chunkIndex < chunkView.byteLength) {\n      const chunkLength = chunkView.getUint32(chunkIndex, true)\n      chunkIndex += 4\n\n      const chunkType = chunkView.getUint32(chunkIndex, true)\n      chunkIndex += 4\n\n      if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\n        const contentArray = new Uint8Array(\n          data,\n          BINARY_EXTENSION_HEADER_LENGTH + chunkIndex,\n          chunkLength,\n        )\n        this.content = LoaderUtils.decodeText(contentArray)\n      } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\n        const byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex\n        this.body = data.slice(byteOffset, byteOffset + chunkLength)\n      }\n\n      // Clients must ignore chunks with unknown types.\n\n      chunkIndex += chunkLength\n    }\n\n    if (this.content === null) {\n      throw new Error('THREE.GLTFLoader: JSON content not found.')\n    }\n  }\n\n  /**\n   * DRACO Mesh Compression Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n   */\n  function GLTFDracoMeshCompressionExtension(json, dracoLoader) {\n    if (!dracoLoader) {\n      throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.')\n    }\n\n    this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION\n    this.json = json\n    this.dracoLoader = dracoLoader\n    this.dracoLoader.preload()\n  }\n\n  GLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function (primitive, parser) {\n    const json = this.json\n    const dracoLoader = this.dracoLoader\n    const bufferViewIndex = primitive.extensions[this.name].bufferView\n    const gltfAttributeMap = primitive.extensions[this.name].attributes\n    const threeAttributeMap = {}\n    const attributeNormalizedMap = {}\n    const attributeTypeMap = {}\n\n    for (let attributeName in gltfAttributeMap) {\n      const threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase()\n\n      threeAttributeMap[threeAttributeName] = gltfAttributeMap[attributeName]\n    }\n\n    for (attributeName in primitive.attributes) {\n      const threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase()\n\n      if (gltfAttributeMap[attributeName] !== undefined) {\n        const accessorDef = json.accessors[primitive.attributes[attributeName]]\n        const componentType = WEBGL_COMPONENT_TYPES[accessorDef.componentType]\n\n        attributeTypeMap[threeAttributeName] = componentType\n        attributeNormalizedMap[threeAttributeName] = accessorDef.normalized === true\n      }\n    }\n\n    return parser.getDependency('bufferView', bufferViewIndex).then(function (bufferView) {\n      return new Promise(function (resolve) {\n        dracoLoader.decodeDracoFile(\n          bufferView,\n          function (geometry) {\n            for (let attributeName in geometry.attributes) {\n              const attribute = geometry.attributes[attributeName]\n              const normalized = attributeNormalizedMap[attributeName]\n\n              if (normalized !== undefined) {\n                attribute.normalized = normalized\n              }\n            }\n\n            resolve(geometry)\n          },\n          threeAttributeMap,\n          attributeTypeMap,\n        )\n      })\n    })\n  }\n\n  /**\n   * Texture Transform Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n   */\n  function GLTFTextureTransformExtension() {\n    this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM\n  }\n\n  GLTFTextureTransformExtension.prototype.extendTexture = function (texture, transform) {\n    texture = texture.clone()\n\n    if (transform.offset !== undefined) {\n      texture.offset.fromArray(transform.offset)\n    }\n\n    if (transform.rotation !== undefined) {\n      texture.rotation = transform.rotation\n    }\n\n    if (transform.scale !== undefined) {\n      texture.repeat.fromArray(transform.scale)\n    }\n\n    if (transform.texCoord !== undefined) {\n      console.warn(\n        'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.',\n      )\n    }\n\n    texture.needsUpdate = true\n\n    return texture\n  }\n\n  /**\n   * Specular-Glossiness Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n   */\n\n  /**\n   * A sub class of StandardMaterial with some of the functionality\n   * changed via the `onBeforeCompile` callback\n   * @pailhead\n   */\n\n  function GLTFMeshStandardSGMaterial(params) {\n    MeshStandardMaterial.call(this)\n\n    this.isGLTFSpecularGlossinessMaterial = true\n\n    //various chunks that need replacing\n    const specularMapParsFragmentChunk = [\n      '#ifdef USE_SPECULARMAP',\n      '\tuniform sampler2D specularMap;',\n      '#endif',\n    ].join('\\n')\n\n    const glossinessMapParsFragmentChunk = [\n      '#ifdef USE_GLOSSINESSMAP',\n      '\tuniform sampler2D glossinessMap;',\n      '#endif',\n    ].join('\\n')\n\n    const specularMapFragmentChunk = [\n      'vec3 specularFactor = specular;',\n      '#ifdef USE_SPECULARMAP',\n      '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n      '\ttexelSpecular = sRGBToLinear( texelSpecular );',\n      '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n      '\tspecularFactor *= texelSpecular.rgb;',\n      '#endif',\n    ].join('\\n')\n\n    const glossinessMapFragmentChunk = [\n      'float glossinessFactor = glossiness;',\n      '#ifdef USE_GLOSSINESSMAP',\n      '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n      '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n      '\tglossinessFactor *= texelGlossiness.a;',\n      '#endif',\n    ].join('\\n')\n\n    const lightPhysicalFragmentChunk = [\n      'PhysicalMaterial material;',\n      'material.diffuseColor = diffuseColor.rgb;',\n      'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n      'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n      'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.',\n      'material.specularRoughness += geometryRoughness;',\n      'material.specularRoughness = min( material.specularRoughness, 1.0 );',\n      'material.specularColor = specularFactor.rgb;',\n    ].join('\\n')\n\n    const uniforms = {\n      specular: { value: new Color().setHex(0xffffff) },\n      glossiness: { value: 1 },\n      specularMap: { value: null },\n      glossinessMap: { value: null },\n    }\n\n    this._extraUniforms = uniforms\n\n    // please see #14031 or #13198 for an alternate approach\n    this.onBeforeCompile = function (shader) {\n      for (let uniformName in uniforms) {\n        shader.uniforms[uniformName] = uniforms[uniformName]\n      }\n\n      shader.fragmentShader = shader.fragmentShader.replace(\n        'uniform float roughness;',\n        'uniform vec3 specular;',\n      )\n      shader.fragmentShader = shader.fragmentShader.replace(\n        'uniform float metalness;',\n        'uniform float glossiness;',\n      )\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <roughnessmap_pars_fragment>',\n        specularMapParsFragmentChunk,\n      )\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <metalnessmap_pars_fragment>',\n        glossinessMapParsFragmentChunk,\n      )\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <roughnessmap_fragment>',\n        specularMapFragmentChunk,\n      )\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <metalnessmap_fragment>',\n        glossinessMapFragmentChunk,\n      )\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <lights_physical_fragment>',\n        lightPhysicalFragmentChunk,\n      )\n    }\n\n    /*eslint-disable*/\n    Object.defineProperties(this, {\n      specular: {\n        get: function () {\n          return uniforms.specular.value\n        },\n        set: function (v) {\n          uniforms.specular.value = v\n        },\n      },\n      specularMap: {\n        get: function () {\n          return uniforms.specularMap.value\n        },\n        set: function (v) {\n          uniforms.specularMap.value = v\n        },\n      },\n      glossiness: {\n        get: function () {\n          return uniforms.glossiness.value\n        },\n        set: function (v) {\n          uniforms.glossiness.value = v\n        },\n      },\n      glossinessMap: {\n        get: function () {\n          return uniforms.glossinessMap.value\n        },\n        set: function (v) {\n          uniforms.glossinessMap.value = v\n          //how about something like this - @pailhead\n          if (v) {\n            this.defines.USE_GLOSSINESSMAP = ''\n            // set USE_ROUGHNESSMAP to enable vUv\n            this.defines.USE_ROUGHNESSMAP = ''\n          } else {\n            delete this.defines.USE_ROUGHNESSMAP\n            delete this.defines.USE_GLOSSINESSMAP\n          }\n        },\n      },\n    })\n\n    /*eslint-enable*/\n    delete this.metalness\n    delete this.roughness\n    delete this.metalnessMap\n    delete this.roughnessMap\n\n    this.setValues(params)\n  }\n\n  GLTFMeshStandardSGMaterial.prototype = Object.create(MeshStandardMaterial.prototype)\n  GLTFMeshStandardSGMaterial.prototype.constructor = GLTFMeshStandardSGMaterial\n\n  GLTFMeshStandardSGMaterial.prototype.copy = function (source) {\n    MeshStandardMaterial.prototype.copy.call(this, source)\n    this.specularMap = source.specularMap\n    this.specular.copy(source.specular)\n    this.glossinessMap = source.glossinessMap\n    this.glossiness = source.glossiness\n    delete this.metalness\n    delete this.roughness\n    delete this.metalnessMap\n    delete this.roughnessMap\n    return this\n  }\n\n  function GLTFMaterialsPbrSpecularGlossinessExtension() {\n    return {\n      name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n      specularGlossinessParams: [\n        'color',\n        'map',\n        'lightMap',\n        'lightMapIntensity',\n        'aoMap',\n        'aoMapIntensity',\n        'emissive',\n        'emissiveIntensity',\n        'emissiveMap',\n        'bumpMap',\n        'bumpScale',\n        'normalMap',\n        'normalMapType',\n        'displacementMap',\n        'displacementScale',\n        'displacementBias',\n        'specularMap',\n        'specular',\n        'glossinessMap',\n        'glossiness',\n        'alphaMap',\n        'envMap',\n        'envMapIntensity',\n        'refractionRatio',\n      ],\n\n      getMaterialType: function () {\n        return GLTFMeshStandardSGMaterial\n      },\n\n      extendParams: function (materialParams, materialDef, parser) {\n        const pbrSpecularGlossiness = materialDef.extensions[this.name]\n\n        materialParams.color = new Color(1.0, 1.0, 1.0)\n        materialParams.opacity = 1.0\n\n        const pending = []\n\n        if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {\n          const array = pbrSpecularGlossiness.diffuseFactor\n\n          materialParams.color.fromArray(array)\n          materialParams.opacity = array[3]\n        }\n\n        if (pbrSpecularGlossiness.diffuseTexture !== undefined) {\n          pending.push(\n            parser.assignTexture(materialParams, 'map', pbrSpecularGlossiness.diffuseTexture),\n          )\n        }\n\n        materialParams.emissive = new Color(0.0, 0.0, 0.0)\n        materialParams.glossiness =\n          pbrSpecularGlossiness.glossinessFactor !== undefined\n            ? pbrSpecularGlossiness.glossinessFactor\n            : 1.0\n        materialParams.specular = new Color(1.0, 1.0, 1.0)\n\n        if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {\n          materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor)\n        }\n\n        if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {\n          const specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture\n          pending.push(parser.assignTexture(materialParams, 'glossinessMap', specGlossMapDef))\n          pending.push(parser.assignTexture(materialParams, 'specularMap', specGlossMapDef))\n        }\n\n        return Promise.all(pending)\n      },\n\n      createMaterial: function (materialParams) {\n        const material = new GLTFMeshStandardSGMaterial(materialParams)\n        material.fog = true\n\n        material.color = materialParams.color\n\n        material.map = materialParams.map === undefined ? null : materialParams.map\n\n        material.lightMap = null\n        material.lightMapIntensity = 1.0\n\n        material.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap\n        material.aoMapIntensity = 1.0\n\n        material.emissive = materialParams.emissive\n        material.emissiveIntensity = 1.0\n        material.emissiveMap =\n          materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap\n\n        material.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap\n        material.bumpScale = 1\n\n        material.normalMap =\n          materialParams.normalMap === undefined ? null : materialParams.normalMap\n        material.normalMapType = TangentSpaceNormalMap\n\n        if (materialParams.normalScale) material.normalScale = materialParams.normalScale\n\n        material.displacementMap = null\n        material.displacementScale = 1\n        material.displacementBias = 0\n\n        material.specularMap =\n          materialParams.specularMap === undefined ? null : materialParams.specularMap\n        material.specular = materialParams.specular\n\n        material.glossinessMap =\n          materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap\n        material.glossiness = materialParams.glossiness\n\n        material.alphaMap = null\n\n        material.envMap = materialParams.envMap === undefined ? null : materialParams.envMap\n        material.envMapIntensity = 1.0\n\n        material.refractionRatio = 0.98\n\n        return material\n      },\n    }\n  }\n\n  /**\n   * Mesh Quantization Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n   */\n  function GLTFMeshQuantizationExtension() {\n    this.name = EXTENSIONS.KHR_MESH_QUANTIZATION\n  }\n\n  /*********************************/\n  /********** INTERPOLATION ********/\n  /*********************************/\n\n  // Spline Interpolation\n  // Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n  function GLTFCubicSplineInterpolant(parameterPositions, sampleValues, sampleSize, resultBuffer) {\n    Interpolant.call(this, parameterPositions, sampleValues, sampleSize, resultBuffer)\n  }\n\n  GLTFCubicSplineInterpolant.prototype = Object.create(Interpolant.prototype)\n  GLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant\n\n  GLTFCubicSplineInterpolant.prototype.copySampleValue_ = function (index) {\n    // Copies a sample value to the result buffer. See description of glTF\n    // CUBICSPLINE values layout in interpolate_() function below.\n\n    const result = this.resultBuffer\n    const values = this.sampleValues\n    const valueSize = this.valueSize\n    const offset = index * valueSize * 3 + valueSize\n\n    for (let i = 0; i !== valueSize; i++) {\n      result[i] = values[offset + i]\n    }\n\n    return result\n  }\n\n  GLTFCubicSplineInterpolant.prototype.beforeStart_ =\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_\n\n  GLTFCubicSplineInterpolant.prototype.afterEnd_ =\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_\n\n  GLTFCubicSplineInterpolant.prototype.interpolate_ = function (i1, t0, t, t1) {\n    const result = this.resultBuffer\n    const values = this.sampleValues\n    const stride = this.valueSize\n\n    const stride2 = stride * 2\n    const stride3 = stride * 3\n\n    const td = t1 - t0\n\n    const p = (t - t0) / td\n    const pp = p * p\n    const ppp = pp * p\n\n    const offset1 = i1 * stride3\n    const offset0 = offset1 - stride3\n\n    const s2 = -2 * ppp + 3 * pp\n    const s3 = ppp - pp\n    const s0 = 1 - s2\n    const s1 = s3 - pp + p\n\n    // Layout of keyframe output values for CUBICSPLINE animations:\n    //   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n    for (let i = 0; i !== stride; i++) {\n      const p0 = values[offset0 + i + stride] // splineVertex_k\n      const m0 = values[offset0 + i + stride2] * td // outTangent_k * (t_k+1 - t_k)\n      const p1 = values[offset1 + i + stride] // splineVertex_k+1\n      const m1 = values[offset1 + i] * td // inTangent_k+1 * (t_k+1 - t_k)\n\n      result[i] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1\n    }\n\n    return result\n  }\n\n  /*********************************/\n  /********** INTERNALS ************/\n  /*********************************/\n\n  /* CONSTANTS */\n\n  const WEBGL_CONSTANTS = {\n    FLOAT: 5126,\n    //FLOAT_MAT2: 35674,\n    FLOAT_MAT3: 35675,\n    FLOAT_MAT4: 35676,\n    FLOAT_VEC2: 35664,\n    FLOAT_VEC3: 35665,\n    FLOAT_VEC4: 35666,\n    LINEAR: 9729,\n    REPEAT: 10497,\n    SAMPLER_2D: 35678,\n    POINTS: 0,\n    LINES: 1,\n    LINE_LOOP: 2,\n    LINE_STRIP: 3,\n    TRIANGLES: 4,\n    TRIANGLE_STRIP: 5,\n    TRIANGLE_FAN: 6,\n    UNSIGNED_BYTE: 5121,\n    UNSIGNED_SHORT: 5123,\n  }\n\n  const WEBGL_COMPONENT_TYPES = {\n    5120: Int8Array,\n    5121: Uint8Array,\n    5122: Int16Array,\n    5123: Uint16Array,\n    5125: Uint32Array,\n    5126: Float32Array,\n  }\n\n  const WEBGL_FILTERS = {\n    9728: NearestFilter,\n    9729: LinearFilter,\n    9984: NearestMipmapNearestFilter,\n    9985: LinearMipmapNearestFilter,\n    9986: NearestMipmapLinearFilter,\n    9987: LinearMipmapLinearFilter,\n  }\n\n  const WEBGL_WRAPPINGS = {\n    33071: ClampToEdgeWrapping,\n    33648: MirroredRepeatWrapping,\n    10497: RepeatWrapping,\n  }\n\n  const WEBGL_TYPE_SIZES = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16,\n  }\n\n  const ATTRIBUTES = {\n    POSITION: 'position',\n    NORMAL: 'normal',\n    TANGENT: 'tangent',\n    TEXCOORD_0: 'uv',\n    TEXCOORD_1: 'uv2',\n    COLOR_0: 'color',\n    WEIGHTS_0: 'skinWeight',\n    JOINTS_0: 'skinIndex',\n  }\n\n  const PATH_PROPERTIES = {\n    scale: 'scale',\n    translation: 'position',\n    rotation: 'quaternion',\n    weights: 'morphTargetInfluences',\n  }\n\n  const INTERPOLATION = {\n    CUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n    // keyframe track will be initialized with a default interpolation type, then modified.\n    LINEAR: InterpolateLinear,\n    STEP: InterpolateDiscrete,\n  }\n\n  const ALPHA_MODES = {\n    OPAQUE: 'OPAQUE',\n    MASK: 'MASK',\n    BLEND: 'BLEND',\n  }\n\n  const MIME_TYPE_FORMATS = {\n    'image/png': RGBAFormat,\n    'image/jpeg': RGBFormat,\n  }\n\n  /* UTILITY FUNCTIONS */\n\n  function resolveURL(url, path) {\n    // Invalid URL\n    if (typeof url !== 'string' || url === '') return ''\n\n    // Host Relative URL\n    if (/^https?:\\/\\//i.test(path) && /^\\//.test(url)) {\n      path = path.replace(/(^https?:\\/\\/[^\\/]+).*/i, '$1')\n    }\n\n    // Absolute URL http://,https://,//\n    if (/^(https?:)?\\/\\//i.test(url)) return url\n\n    // Data URI\n    if (/^data:.*,.*$/i.test(url)) return url\n\n    // Blob URL\n    if (/^blob:.*$/i.test(url)) return url\n\n    // Relative URL\n    return path + url\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n   */\n  function createDefaultMaterial(cache) {\n    if (cache['DefaultMaterial'] === undefined) {\n      cache['DefaultMaterial'] = new MeshStandardMaterial({\n        color: 0xffffff,\n        emissive: 0x000000,\n        metalness: 1,\n        roughness: 1,\n        transparent: false,\n        depthTest: true,\n        side: FrontSide,\n      })\n    }\n\n    return cache['DefaultMaterial']\n  }\n\n  function addUnknownExtensionsToUserData(knownExtensions, object, objectDef) {\n    // Add unknown glTF extensions to an object's userData.\n\n    for (let name in objectDef.extensions) {\n      if (knownExtensions[name] === undefined) {\n        object.userData.gltfExtensions = object.userData.gltfExtensions || {}\n        object.userData.gltfExtensions[name] = objectDef.extensions[name]\n      }\n    }\n  }\n\n  /**\n   * @param {Object3D|Material|BufferGeometry} object\n   * @param {GLTF.definition} gltfDef\n   */\n  function assignExtrasToUserData(object, gltfDef) {\n    if (gltfDef.extras !== undefined) {\n      if (typeof gltfDef.extras === 'object') {\n        Object.assign(object.userData, gltfDef.extras)\n      } else {\n        console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras)\n      }\n    }\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n   *\n   * @param {BufferGeometry} geometry\n   * @param {Array<GLTF.Target>} targets\n   * @param {GLTFParser} parser\n   * @return {Promise<BufferGeometry>}\n   */\n  function addMorphTargets(geometry, targets, parser) {\n    let hasMorphPosition = false\n    let hasMorphNormal = false\n\n    for (let i = 0, il = targets.length; i < il; i++) {\n      const target = targets[i]\n\n      if (target.POSITION !== undefined) {\n        hasMorphPosition = true\n      }\n      if (target.NORMAL !== undefined) {\n        hasMorphNormal = true\n      }\n\n      if (hasMorphPosition && hasMorphNormal) {\n        break\n      }\n    }\n\n    if (!hasMorphPosition && !hasMorphNormal) {\n      return Promise.resolve(geometry)\n    }\n\n    const pendingPositionAccessors = []\n    const pendingNormalAccessors = []\n\n    for (let i = 0, il = targets.length; i < il; i++) {\n      const target = targets[i]\n\n      if (hasMorphPosition) {\n        const pendingAccessor =\n          target.POSITION !== undefined\n            ? parser.getDependency('accessor', target.POSITION)\n            : geometry.attributes.position\n\n        pendingPositionAccessors.push(pendingAccessor)\n      }\n\n      if (hasMorphNormal) {\n        const pendingAccessor =\n          target.NORMAL !== undefined\n            ? parser.getDependency('accessor', target.NORMAL)\n            : geometry.attributes.normal\n\n        pendingNormalAccessors.push(pendingAccessor)\n      }\n    }\n\n    return Promise.all([\n      Promise.all(pendingPositionAccessors),\n      Promise.all(pendingNormalAccessors),\n    ]).then(function (accessors) {\n      const morphPositions = accessors[0]\n      const morphNormals = accessors[1]\n\n      if (hasMorphPosition) {\n        geometry.morphAttributes.position = morphPositions\n      }\n      if (hasMorphNormal) {\n        geometry.morphAttributes.normal = morphNormals\n      }\n      geometry.morphTargetsRelative = true\n\n      return geometry\n    })\n  }\n\n  /**\n   * @param {Mesh} mesh\n   * @param {GLTF.Mesh} meshDef\n   */\n  function updateMorphTargets(mesh, meshDef) {\n    mesh.updateMorphTargets()\n\n    if (meshDef.weights !== undefined) {\n      for (let i = 0, il = meshDef.weights.length; i < il; i++) {\n        mesh.morphTargetInfluences[i] = meshDef.weights[i]\n      }\n    }\n\n    // .extras has user-defined data, so check that .extras.targetNames is an array.\n    if (meshDef.extras && Array.isArray(meshDef.extras.targetNames)) {\n      const targetNames = meshDef.extras.targetNames\n\n      if (mesh.morphTargetInfluences.length === targetNames.length) {\n        mesh.morphTargetDictionary = {}\n\n        for (let i = 0, il = targetNames.length; i < il; i++) {\n          mesh.morphTargetDictionary[targetNames[i]] = i\n        }\n      } else {\n        console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.')\n      }\n    }\n  }\n\n  function createPrimitiveKey(primitiveDef) {\n    const dracoExtension =\n      primitiveDef.extensions && primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]\n\n    if (dracoExtension) {\n      const { bufferView, indices, attributes } = dracoExtension\n      return `draco:${bufferView}:${indices}:${attributes}`\n    } else {\n      const { indices, attributes, mode } = primitiveDef\n      return `${indices}:${createAttributesKey(attributes)}:${mode}`\n    }\n  }\n\n  function createAttributesKey(attributes) {\n    let attributesKey = ''\n\n    const keys = Object.keys(attributes).sort()\n\n    for (let i = 0, il = keys.length; i < il; i++) {\n      attributesKey += keys[i] + ':' + attributes[keys[i]] + ';'\n    }\n\n    return attributesKey\n  }\n\n  /* GLTF PARSER */\n\n  function GLTFParser(json, options) {\n    this.json = json || {}\n    this.extensions = {}\n    this.plugins = {}\n    this.options = options || {}\n\n    // loader object cache\n    this.cache = new GLTFRegistry()\n\n    // associations between Three.js objects and glTF elements\n    this.associations = new Map()\n\n    // BufferGeometry caching\n    this.primitiveCache = {}\n\n    // Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n    // expensive work of uploading a texture to the GPU off the main thread.\n    if (typeof createImageBitmap !== 'undefined' && /Firefox/.test(navigator.userAgent) === false) {\n      this.textureLoader = new ImageBitmapLoader(this.options.manager)\n    } else {\n      this.textureLoader = new TextureLoader(this.options.manager)\n    }\n\n    this.textureLoader.setCrossOrigin(this.options.crossOrigin)\n\n    this.fileLoader = new FileLoader(this.options.manager)\n    this.fileLoader.setResponseType('arraybuffer')\n\n    if (this.options.crossOrigin === 'use-credentials') {\n      this.fileLoader.setWithCredentials(true)\n    }\n  }\n\n  GLTFParser.prototype.setExtensions = function (extensions) {\n    this.extensions = extensions\n  }\n\n  GLTFParser.prototype.setPlugins = function (plugins) {\n    this.plugins = plugins\n  }\n\n  GLTFParser.prototype.parse = function (onLoad, onError) {\n    const parser = this\n    const { extensions, json } = this\n\n    // Clear the loader cache\n    this.cache.removeAll()\n\n    // Mark the special nodes/meshes in json for efficient parse\n    this.markDefs()\n\n    Promise.all([\n      this.getDependencies('scene'),\n      this.getDependencies('animation'),\n      this.getDependencies('camera'),\n    ])\n      .then(function (dependencies) {\n        const result = {\n          scene: dependencies[0][json.scene || 0],\n          scenes: dependencies[0],\n          animations: dependencies[1],\n          cameras: dependencies[2],\n          asset: json.asset,\n          parser: parser,\n          userData: {},\n        }\n\n        addUnknownExtensionsToUserData(extensions, result, json)\n\n        assignExtrasToUserData(result, json)\n\n        onLoad(result)\n      })\n      .catch(onError)\n  }\n\n  /**\n   * Marks the special nodes/meshes in json for efficient parse.\n   */\n  GLTFParser.prototype.markDefs = function () {\n    const nodeDefs = this.json.nodes || []\n    const skinDefs = this.json.skins || []\n    const meshDefs = this.json.meshes || []\n\n    const meshReferences = {}\n    const meshUses = {}\n\n    // Nothing in the node definition indicates whether it is a Bone or an\n    // Object3D. Use the skins' joint references to mark bones.\n    for (let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex++) {\n      const joints = skinDefs[skinIndex].joints\n\n      for (let i = 0, il = joints.length; i < il; i++) {\n        nodeDefs[joints[i]].isBone = true\n      }\n    }\n\n    // Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n    // avoid having more than one Mesh with the same name, count\n    // references and rename instances below.\n    //\n    // Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n    for (let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {\n      const nodeDef = nodeDefs[nodeIndex]\n\n      if (nodeDef.mesh !== undefined) {\n        if (meshReferences[nodeDef.mesh] === undefined) {\n          meshReferences[nodeDef.mesh] = meshUses[nodeDef.mesh] = 0\n        }\n\n        meshReferences[nodeDef.mesh]++\n\n        // Nothing in the mesh definition indicates whether it is\n        // a SkinnedMesh or Mesh. Use the node's mesh reference\n        // to mark SkinnedMesh if node has skin.\n        if (nodeDef.skin !== undefined) {\n          meshDefs[nodeDef.mesh].isSkinnedMesh = true\n        }\n      }\n    }\n\n    this.json.meshReferences = meshReferences\n    this.json.meshUses = meshUses\n  }\n\n  GLTFParser.prototype._invokeOne = function (func) {\n    const extensions = Object.values(this.plugins)\n    extensions.push(this)\n\n    for (let i = 0; i < extensions.length; i++) {\n      const result = func(extensions[i])\n\n      if (result) {\n        return result\n      }\n    }\n  }\n\n  GLTFParser.prototype._invokeAll = function (func) {\n    const extensions = Object.values(this.plugins)\n    extensions.unshift(this)\n\n    const pending = []\n\n    for (let i = 0; i < extensions.length; i++) {\n      pending.push(func(extensions[i]))\n    }\n\n    return Promise.all(pending)\n  }\n\n  /**\n   * Requests the specified dependency asynchronously, with caching.\n   * @param {string} type\n   * @param {number} index\n   * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n   */\n  GLTFParser.prototype.getDependency = function (type, index) {\n    const cacheKey = type + ':' + index\n    let dependency = this.cache.get(cacheKey)\n\n    if (!dependency) {\n      switch (type) {\n        case 'scene':\n          dependency = this.loadScene(index)\n          break\n\n        case 'node':\n          dependency = this.loadNode(index)\n          break\n\n        case 'mesh':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadMesh && ext.loadMesh(index)\n          })\n          break\n\n        case 'accessor':\n          dependency = this.loadAccessor(index)\n          break\n\n        case 'bufferView':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadBufferView && ext.loadBufferView(index)\n          })\n          break\n\n        case 'buffer':\n          dependency = this.loadBuffer(index)\n          break\n\n        case 'material':\n          dependency = this._invokeOne(function (ext) {\n            return ext.loadMaterial && ext.loadMaterial(index)\n          })\n          break\n\n        case 'texture':\n          dependency = this.loadTexture(index)\n          break\n\n        case 'skin':\n          dependency = this.loadSkin(index)\n          break\n\n        case 'animation':\n          dependency = this.loadAnimation(index)\n          break\n\n        case 'camera':\n          dependency = this.loadCamera(index)\n          break\n\n        case 'light':\n          dependency = this.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].loadLight(index)\n          break\n\n        default:\n          throw new Error('Unknown type: ' + type)\n      }\n\n      this.cache.add(cacheKey, dependency)\n    }\n\n    return dependency\n  }\n\n  /**\n   * Requests all dependencies of the specified type asynchronously, with caching.\n   * @param {string} type\n   * @return {Promise<Array<Object>>}\n   */\n  GLTFParser.prototype.getDependencies = function (type) {\n    let dependencies = this.cache.get(type)\n\n    if (!dependencies) {\n      const parser = this\n      const defs = this.json[type + (type === 'mesh' ? 'es' : 's')] || []\n\n      dependencies = Promise.all(defs.map((def, index) => parser.getDependency(type, index)))\n\n      this.cache.add(type, dependencies)\n    }\n\n    return dependencies\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  GLTFParser.prototype.loadBuffer = function (bufferIndex) {\n    const bufferDef = this.json.buffers[bufferIndex]\n    const loader = this.fileLoader\n\n    if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\n      throw new Error('THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.')\n    }\n\n    // If present, GLB container is required to be the first buffer.\n    if (bufferDef.uri === undefined && bufferIndex === 0) {\n      return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body)\n    }\n\n    const options = this.options\n\n    return new Promise(function (resolve, reject) {\n      loader.load(resolveURL(bufferDef.uri, options.path), resolve, undefined, function () {\n        reject(new Error('THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".'))\n      })\n    })\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferViewIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  GLTFParser.prototype.loadBufferView = function (bufferViewIndex) {\n    const bufferViewDef = this.json.bufferViews[bufferViewIndex]\n\n    return this.getDependency('buffer', bufferViewDef.buffer).then(function (buffer) {\n      const { byteLength = 0, byteOffset = 0 } = bufferViewDef\n      return buffer.slice(byteOffset, byteOffset + byteLength)\n    })\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n   * @param {number} accessorIndex\n   * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n   */\n  GLTFParser.prototype.loadAccessor = function (accessorIndex) {\n    const parser = this\n    const json = this.json\n\n    const accessorDef = this.json.accessors[accessorIndex]\n\n    if (accessorDef.bufferView === undefined && accessorDef.sparse === undefined) {\n      // Ignore empty accessors, which may be used to declare runtime\n      // information about attributes coming from another source (e.g. Draco\n      // compression extension).\n      return Promise.resolve(null)\n    }\n\n    const pendingBufferViews = []\n\n    if (accessorDef.bufferView !== undefined) {\n      pendingBufferViews.push(this.getDependency('bufferView', accessorDef.bufferView))\n    } else {\n      pendingBufferViews.push(null)\n    }\n\n    if (accessorDef.sparse !== undefined) {\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.indices.bufferView),\n      )\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.values.bufferView),\n      )\n    }\n\n    return Promise.all(pendingBufferViews).then(function (bufferViews) {\n      const bufferView = bufferViews[0]\n\n      const itemSize = WEBGL_TYPE_SIZES[accessorDef.type]\n      const TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType]\n\n      // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n      const elementBytes = TypedArray.BYTES_PER_ELEMENT\n      const itemBytes = elementBytes * itemSize\n      const byteOffset = accessorDef.byteOffset || 0\n      const byteStride =\n        accessorDef.bufferView !== undefined\n          ? json.bufferViews[accessorDef.bufferView].byteStride\n          : undefined\n\n      const normalized = accessorDef.normalized === true\n\n      let array\n      let bufferAttribute\n\n      // The buffer is not interleaved if the stride is the item size in bytes.\n      if (byteStride && byteStride !== itemBytes) {\n        // Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n        // This makes sure that IBA.count reflects accessor.count properly\n        const ibSlice = Math.floor(byteOffset / byteStride)\n        const { bufferView, componentType, count } = accessorDef\n        const ibCacheKey = `InterleavedBuffer:${bufferView}:${componentType}:${ibSlice}:${count}`\n\n        const ib = parser.cache.get(ibCacheKey)\n\n        if (!ib) {\n          array = new TypedArray(\n            bufferView,\n            ibSlice * byteStride,\n            (accessorDef.count * byteStride) / elementBytes,\n          )\n\n          // Integer parameters to IB/IBA are in array elements, not bytes.\n          ib = new InterleavedBuffer(array, byteStride / elementBytes)\n\n          parser.cache.add(ibCacheKey, ib)\n        }\n\n        bufferAttribute = new InterleavedBufferAttribute(\n          ib,\n          itemSize,\n          (byteOffset % byteStride) / elementBytes,\n          normalized,\n        )\n      } else {\n        if (bufferView === null) {\n          array = new TypedArray(accessorDef.count * itemSize)\n        } else {\n          array = new TypedArray(bufferView, byteOffset, accessorDef.count * itemSize)\n        }\n\n        bufferAttribute = new BufferAttribute(array, itemSize, normalized)\n      }\n\n      // https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n      if (accessorDef.sparse !== undefined) {\n        const itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR\n        const TypedArrayIndices = WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType]\n\n        const byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0\n        const byteOffsetValues = accessorDef.sparse.values.byteOffset || 0\n\n        const sparseIndices = new TypedArrayIndices(\n          bufferViews[1],\n          byteOffsetIndices,\n          accessorDef.sparse.count * itemSizeIndices,\n        )\n        const sparseValues = new TypedArray(\n          bufferViews[2],\n          byteOffsetValues,\n          accessorDef.sparse.count * itemSize,\n        )\n\n        if (bufferView !== null) {\n          // Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n          bufferAttribute = new BufferAttribute(\n            bufferAttribute.array.slice(),\n            bufferAttribute.itemSize,\n            bufferAttribute.normalized,\n          )\n        }\n\n        for (let i = 0, il = sparseIndices.length; i < il; i++) {\n          const index = sparseIndices[i]\n\n          bufferAttribute.setX(index, sparseValues[i * itemSize])\n          if (itemSize >= 2) {\n            bufferAttribute.setY(index, sparseValues[i * itemSize + 1])\n          }\n          if (itemSize >= 3) {\n            bufferAttribute.setZ(index, sparseValues[i * itemSize + 2])\n          }\n          if (itemSize >= 4) {\n            bufferAttribute.setW(index, sparseValues[i * itemSize + 3])\n          }\n          if (itemSize >= 5) {\n            throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.')\n          }\n        }\n      }\n\n      return bufferAttribute\n    })\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n   * @param {number} textureIndex\n   * @return {Promise<THREE.Texture>}\n   */\n  GLTFParser.prototype.loadTexture = function (textureIndex) {\n    const parser = this\n    const { json, options, textureLoader } = this\n\n    const URL = self.URL || self.webkitURL\n\n    const textureDef = json.textures[textureIndex]\n\n    const textureExtensions = textureDef.extensions || {}\n\n    let source\n\n    if (textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]) {\n      source = json.images[textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS].source]\n    } else {\n      source = json.images[textureDef.source]\n    }\n\n    let sourceURI = source.uri\n    let isObjectURL = false\n\n    if (source.bufferView !== undefined) {\n      // Load binary image data from bufferView, if provided.\n\n      sourceURI = parser.getDependency('bufferView', source.bufferView).then(function (bufferView) {\n        isObjectURL = true\n        const blob = new Blob([bufferView], { type: source.mimeType })\n        sourceURI = URL.createObjectURL(blob)\n        return sourceURI\n      })\n    }\n\n    return Promise.resolve(sourceURI)\n      .then(function (sourceURI) {\n        // Load Texture resource.\n\n        let loader = options.manager.getHandler(sourceURI)\n\n        if (!loader) {\n          loader = textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]\n            ? parser.extensions[EXTENSIONS.MSFT_TEXTURE_DDS].ddsLoader\n            : textureLoader\n        }\n\n        return new Promise(function (resolve, reject) {\n          let onLoad = resolve\n\n          if (loader.isImageBitmapLoader === true) {\n            onLoad = imageBitmap => resolve(new CanvasTexture(imageBitmap))\n          }\n\n          loader.load(resolveURL(sourceURI, options.path), onLoad, undefined, reject)\n        })\n      })\n      .then(function (texture) {\n        // Clean up resources and configure Texture.\n\n        if (isObjectURL === true) {\n          URL.revokeObjectURL(sourceURI)\n        }\n\n        texture.flipY = false\n\n        if (textureDef.name) {\n          texture.name = textureDef.name\n        }\n\n        // Ignore unknown mime types, like DDS files.\n        if (source.mimeType in MIME_TYPE_FORMATS) {\n          texture.format = MIME_TYPE_FORMATS[source.mimeType]\n        }\n\n        const samplers = json.samplers || {}\n        const sampler = samplers[textureDef.sampler] || {}\n\n        texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter\n        texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipmapLinearFilter\n        texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping\n        texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping\n\n        parser.associations.set(texture, {\n          type: 'textures',\n          index: textureIndex,\n        })\n\n        return texture\n      })\n  }\n\n  /**\n   * Asynchronously assigns a texture to the given material parameters.\n   * @param {Object} materialParams\n   * @param {string} mapName\n   * @param {Object} mapDef\n   * @return {Promise}\n   */\n  GLTFParser.prototype.assignTexture = function (materialParams, mapName, mapDef) {\n    const parser = this\n\n    return this.getDependency('texture', mapDef.index).then(function (texture) {\n      if (!texture.isCompressedTexture) {\n        switch (mapName) {\n          case 'aoMap':\n          case 'emissiveMap':\n          case 'metalnessMap':\n          case 'normalMap':\n          case 'roughnessMap':\n            texture.format = RGBFormat\n            break\n        }\n      }\n\n      // Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n      // However, we will copy UV set 0 to UV set 1 on demand for aoMap\n      if (\n        mapDef.texCoord !== undefined &&\n        mapDef.texCoord != 0 &&\n        !(mapName === 'aoMap' && mapDef.texCoord == 1)\n      ) {\n        console.warn(\n          'THREE.GLTFLoader: Custom UV set ' +\n            mapDef.texCoord +\n            ' for texture ' +\n            mapName +\n            ' not yet supported.',\n        )\n      }\n\n      if (parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {\n        const transform =\n          mapDef.extensions !== undefined\n            ? mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]\n            : undefined\n\n        if (transform) {\n          const gltfReference = parser.associations.get(texture)\n          texture = parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(\n            texture,\n            transform,\n          )\n          parser.associations.set(texture, gltfReference)\n        }\n      }\n\n      materialParams[mapName] = texture\n    })\n  }\n\n  /**\n   * Assigns final material to a Mesh, Line, or Points instance. The instance\n   * already has a material (generated from the glTF material options alone)\n   * but reuse of the same glTF material may require multiple threejs materials\n   * to accomodate different primitive types, defines, etc. New materials will\n   * be created if necessary, and reused from a cache.\n   * @param  {Object3D} mesh Mesh, Line, or Points instance.\n   */\n  GLTFParser.prototype.assignFinalMaterial = function (mesh) {\n    const geometry = mesh.geometry\n    let material = mesh.material\n\n    const useVertexTangents = geometry.attributes.tangent !== undefined\n    const useVertexColors = geometry.attributes.color !== undefined\n    const useFlatShading = geometry.attributes.normal === undefined\n    const useSkinning = mesh.isSkinnedMesh === true\n    const useMorphTargets = Object.keys(geometry.morphAttributes).length > 0\n    const useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined\n\n    if (mesh.isPoints) {\n      let cacheKey = 'PointsMaterial:' + material.uuid\n\n      const pointsMaterial = this.cache.get(cacheKey)\n\n      if (!pointsMaterial) {\n        pointsMaterial = new PointsMaterial()\n        Material.prototype.copy.call(pointsMaterial, material)\n        pointsMaterial.color.copy(material.color)\n        pointsMaterial.map = material.map\n        pointsMaterial.sizeAttenuation = false // glTF spec says points should be 1px\n\n        this.cache.add(cacheKey, pointsMaterial)\n      }\n\n      material = pointsMaterial\n    } else if (mesh.isLine) {\n      const cacheKey = 'LineBasicMaterial:' + material.uuid\n\n      const lineMaterial = this.cache.get(cacheKey)\n\n      if (!lineMaterial) {\n        lineMaterial = new LineBasicMaterial()\n        Material.prototype.copy.call(lineMaterial, material)\n        lineMaterial.color.copy(material.color)\n\n        this.cache.add(cacheKey, lineMaterial)\n      }\n\n      material = lineMaterial\n    }\n\n    // Clone the material if it will be modified\n    if (useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets) {\n      let cacheKey = 'ClonedMaterial:' + material.uuid + ':'\n\n      if (material.isGLTFSpecularGlossinessMaterial) {\n        cacheKey += 'specular-glossiness:'\n      }\n      if (useSkinning) {\n        cacheKey += 'skinning:'\n      }\n      if (useVertexTangents) {\n        cacheKey += 'vertex-tangents:'\n      }\n      if (useVertexColors) {\n        cacheKey += 'vertex-colors:'\n      }\n      if (useFlatShading) {\n        cacheKey += 'flat-shading:'\n      }\n      if (useMorphTargets) {\n        cacheKey += 'morph-targets:'\n      }\n      if (useMorphNormals) {\n        cacheKey += 'morph-normals:'\n      }\n\n      let cachedMaterial = this.cache.get(cacheKey)\n\n      if (!cachedMaterial) {\n        cachedMaterial = material.clone()\n\n        if (useSkinning) cachedMaterial.skinning = true\n        if (useVertexTangents) cachedMaterial.vertexTangents = true\n        if (useVertexColors) cachedMaterial.vertexColors = true\n        if (useFlatShading) cachedMaterial.flatShading = true\n        if (useMorphTargets) cachedMaterial.morphTargets = true\n        if (useMorphNormals) cachedMaterial.morphNormals = true\n\n        this.cache.add(cacheKey, cachedMaterial)\n\n        this.associations.set(cachedMaterial, this.associations.get(material))\n      }\n\n      material = cachedMaterial\n    }\n\n    // workarounds for mesh and geometry\n\n    if (\n      material.aoMap &&\n      geometry.attributes.uv2 === undefined &&\n      geometry.attributes.uv !== undefined\n    ) {\n      geometry.setAttribute('uv2', geometry.attributes.uv)\n    }\n\n    // https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n    if (material.normalScale && !useVertexTangents) {\n      material.normalScale.y = -material.normalScale.y\n    }\n\n    if (material.clearcoatNormalScale && !useVertexTangents) {\n      material.clearcoatNormalScale.y = -material.clearcoatNormalScale.y\n    }\n\n    mesh.material = material\n  }\n\n  GLTFParser.prototype.getMaterialType = function (/* materialIndex */) {\n    return MeshStandardMaterial\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n   * @param {number} materialIndex\n   * @return {Promise<Material>}\n   */\n  GLTFParser.prototype.loadMaterial = function (materialIndex) {\n    const parser = this\n    const { extensions, json } = this\n\n    const materialDef = json.materials[materialIndex]\n\n    let materialType\n    const materialParams = {}\n    const materialExtensions = materialDef.extensions || {}\n\n    const pending = []\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {\n      const sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]\n      materialType = sgExtension.getMaterialType()\n      pending.push(sgExtension.extendParams(materialParams, materialDef, parser))\n    } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]) {\n      const kmuExtension = extensions[EXTENSIONS.KHR_MATERIALS_UNLIT]\n      materialType = kmuExtension.getMaterialType()\n      pending.push(kmuExtension.extendParams(materialParams, materialDef, parser))\n    } else {\n      // Specification:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n      const metallicRoughness = materialDef.pbrMetallicRoughness || {}\n\n      materialParams.color = new Color(1.0, 1.0, 1.0)\n      materialParams.opacity = 1.0\n\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        const array = metallicRoughness.baseColorFactor\n\n        materialParams.color.fromArray(array)\n        materialParams.opacity = array[3]\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture),\n        )\n      }\n\n      materialParams.metalness =\n        metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0\n      materialParams.roughness =\n        metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0\n\n      if (metallicRoughness.metallicRoughnessTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'metalnessMap',\n            metallicRoughness.metallicRoughnessTexture,\n          ),\n        )\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'roughnessMap',\n            metallicRoughness.metallicRoughnessTexture,\n          ),\n        )\n      }\n\n      materialType = this._invokeOne(\n        ext => ext.getMaterialType && ext.getMaterialType(materialIndex),\n      )\n\n      pending.push(\n        this._invokeAll(\n          ext =>\n            ext.extendMaterialParams && ext.extendMaterialParams(materialIndex, materialParams),\n        ),\n      )\n    }\n\n    if (materialDef.doubleSided === true) {\n      materialParams.side = DoubleSide\n    }\n\n    const alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE\n\n    if (alphaMode === ALPHA_MODES.BLEND) {\n      materialParams.transparent = true\n\n      // See: https://github.com/mrdoob/three.js/issues/17706\n      materialParams.depthWrite = false\n    } else {\n      materialParams.transparent = false\n\n      if (alphaMode === ALPHA_MODES.MASK) {\n        materialParams.alphaTest =\n          materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5\n      }\n    }\n\n    if (materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'normalMap', materialDef.normalTexture))\n\n      materialParams.normalScale = new Vector2(1, 1)\n\n      if (materialDef.normalTexture.scale !== undefined) {\n        materialParams.normalScale.set(\n          materialDef.normalTexture.scale,\n          materialDef.normalTexture.scale,\n        )\n      }\n    }\n\n    if (materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'aoMap', materialDef.occlusionTexture))\n\n      if (materialDef.occlusionTexture.strength !== undefined) {\n        materialParams.aoMapIntensity = materialDef.occlusionTexture.strength\n      }\n    }\n\n    if (materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial) {\n      materialParams.emissive = new Color().fromArray(materialDef.emissiveFactor)\n    }\n\n    if (materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'emissiveMap', materialDef.emissiveTexture))\n    }\n\n    return Promise.all(pending).then(function () {\n      let material\n\n      if (materialType === GLTFMeshStandardSGMaterial) {\n        material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(\n          materialParams,\n        )\n      } else {\n        material = new materialType(materialParams)\n      }\n\n      if (materialDef.name) {\n        material.name = materialDef.name\n      }\n\n      // baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n      if (material.map) material.map.encoding = sRGBEncoding\n      if (material.emissiveMap) material.emissiveMap.encoding = sRGBEncoding\n\n      assignExtrasToUserData(material, materialDef)\n\n      parser.associations.set(material, { type: 'materials', index: materialIndex })\n\n      if (materialDef.extensions) {\n        addUnknownExtensionsToUserData(extensions, material, materialDef)\n      }\n\n      return material\n    })\n  }\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {GLTF.Primitive} primitiveDef\n   * @param {GLTFParser} parser\n   */\n  function computeBounds(geometry, primitiveDef, parser) {\n    const attributes = primitiveDef.attributes\n\n    const box = new Box3()\n\n    if (attributes.POSITION !== undefined) {\n      const accessor = parser.json.accessors[attributes.POSITION]\n\n      const { max, min } = accessor\n\n      // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n      if (min !== undefined && max !== undefined) {\n        box.set(new Vector3(min[0], min[1], min[2]), new Vector3(max[0], max[1], max[2]))\n      } else {\n        console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.')\n\n        return\n      }\n    } else {\n      return\n    }\n\n    const targets = primitiveDef.targets\n\n    if (targets !== undefined) {\n      const maxDisplacement = new Vector3()\n      const vector = new Vector3()\n\n      for (let i = 0, il = targets.length; i < il; i++) {\n        const target = targets[i]\n\n        if (target.POSITION !== undefined) {\n          const accessor = parser.json.accessors[target.POSITION]\n          const { max, min } = accessor\n\n          // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n          if (min !== undefined && max !== undefined) {\n            // we need to get max of absolute components because target weight is [-1,1]\n            vector.setX(Math.max(Math.abs(min[0]), Math.abs(max[0])))\n            vector.setY(Math.max(Math.abs(min[1]), Math.abs(max[1])))\n            vector.setZ(Math.max(Math.abs(min[2]), Math.abs(max[2])))\n\n            // Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n            // to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n            // are used to implement key-frame animations and as such only two are active at a time - this results in very large\n            // boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n            maxDisplacement.max(vector)\n          } else {\n            console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.')\n          }\n        }\n      }\n\n      // As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n      box.expandByVector(maxDisplacement)\n    }\n\n    geometry.boundingBox = box\n\n    const sphere = new Sphere()\n\n    box.getCenter(sphere.center)\n    sphere.radius = box.min.distanceTo(box.max) / 2\n\n    geometry.boundingSphere = sphere\n  }\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {GLTF.Primitive} primitiveDef\n   * @param {GLTFParser} parser\n   * @return {Promise<BufferGeometry>}\n   */\n  function addPrimitiveAttributes(geometry, primitiveDef, parser) {\n    const attributes = primitiveDef.attributes\n\n    const pending = []\n\n    const assignAttributeAccessor = (accessorIndex, attributeName) =>\n      parser.getDependency('accessor', accessorIndex).then(function (accessor) {\n        geometry.setAttribute(attributeName, accessor)\n      })\n\n    for (let gltfAttributeName in attributes) {\n      const threeAttributeName = ATTRIBUTES[gltfAttributeName] || gltfAttributeName.toLowerCase()\n\n      // Skip attributes already provided by e.g. Draco extension.\n      if (threeAttributeName in geometry.attributes) {\n        continue\n      }\n\n      pending.push(assignAttributeAccessor(attributes[gltfAttributeName], threeAttributeName))\n    }\n\n    if (primitiveDef.indices !== undefined && !geometry.index) {\n      const accessor = parser\n        .getDependency('accessor', primitiveDef.indices)\n        .then(function (accessor) {\n          geometry.setIndex(accessor)\n        })\n\n      pending.push(accessor)\n    }\n\n    assignExtrasToUserData(geometry, primitiveDef)\n\n    computeBounds(geometry, primitiveDef, parser)\n\n    return Promise.all(pending).then(() =>\n      primitiveDef.targets !== undefined\n        ? addMorphTargets(geometry, primitiveDef.targets, parser)\n        : geometry,\n    )\n  }\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {Number} drawMode\n   * @return {BufferGeometry}\n   */\n  function toTrianglesDrawMode(geometry, drawMode) {\n    const index = geometry.getIndex()\n\n    // generate index if not present\n\n    if (index === null) {\n      const indices = []\n\n      const position = geometry.getAttribute('position')\n\n      if (position !== undefined) {\n        for (let i = 0; i < position.count; i++) {\n          indices.push(i)\n        }\n\n        geometry.setIndex(indices)\n        index = geometry.getIndex()\n      } else {\n        console.error(\n          'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.',\n        )\n        return geometry\n      }\n    }\n\n    //\n\n    const numberOfTriangles = index.count - 2\n    const newIndices = []\n\n    if (drawMode === TriangleFanDrawMode) {\n      // gl.TRIANGLE_FAN\n\n      for (let i = 1; i <= numberOfTriangles; i++) {\n        newIndices.push(index.getX(0))\n        newIndices.push(index.getX(i))\n        newIndices.push(index.getX(i + 1))\n      }\n    } else {\n      // gl.TRIANGLE_STRIP\n\n      for (let i = 0; i < numberOfTriangles; i++) {\n        if (i % 2 === 0) {\n          newIndices.push(index.getX(i))\n          newIndices.push(index.getX(i + 1))\n          newIndices.push(index.getX(i + 2))\n        } else {\n          newIndices.push(index.getX(i + 2))\n          newIndices.push(index.getX(i + 1))\n          newIndices.push(index.getX(i))\n        }\n      }\n    }\n\n    if (newIndices.length / 3 !== numberOfTriangles) {\n      console.error(\n        'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.',\n      )\n    }\n\n    // build final geometry\n\n    const newGeometry = geometry.clone()\n    newGeometry.setIndex(newIndices)\n\n    return newGeometry\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n   *\n   * Creates BufferGeometries from primitives.\n   *\n   * @param {Array<GLTF.Primitive>} primitives\n   * @return {Promise<Array<BufferGeometry>>}\n   */\n  GLTFParser.prototype.loadGeometries = function (primitives) {\n    const parser = this\n    const extensions = this.extensions\n    const cache = this.primitiveCache\n\n    const createDracoPrimitive = primitive =>\n      extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]\n        .decodePrimitive(primitive, parser)\n        .then(geometry => addPrimitiveAttributes(geometry, primitive, parser))\n\n    const pending = []\n\n    for (let i = 0, il = primitives.length; i < il; i++) {\n      const primitive = primitives[i]\n      const cacheKey = createPrimitiveKey(primitive)\n\n      // See if we've already created this geometry\n      const cached = cache[cacheKey]\n\n      if (cached) {\n        // Use the cached geometry if it exists\n        pending.push(cached.promise)\n      } else {\n        let geometryPromise\n\n        if (primitive.extensions && primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]) {\n          // Use DRACO geometry if available\n          geometryPromise = createDracoPrimitive(primitive)\n        } else {\n          // Otherwise create a new geometry\n          geometryPromise = addPrimitiveAttributes(new BufferGeometry(), primitive, parser)\n        }\n\n        // Cache this geometry\n        cache[cacheKey] = { primitive: primitive, promise: geometryPromise }\n\n        pending.push(geometryPromise)\n      }\n    }\n\n    return Promise.all(pending)\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n   * @param {number} meshIndex\n   * @return {Promise<Group|Mesh|SkinnedMesh>}\n   */\n  GLTFParser.prototype.loadMesh = function (meshIndex) {\n    const parser = this\n    const { json } = this\n\n    const meshDef = json.meshes[meshIndex]\n    const primitives = meshDef.primitives\n\n    const pending = []\n\n    for (let i = 0, il = primitives.length; i < il; i++) {\n      const material =\n        primitives[i].material === undefined\n          ? createDefaultMaterial(this.cache)\n          : this.getDependency('material', primitives[i].material)\n\n      pending.push(material)\n    }\n\n    pending.push(parser.loadGeometries(primitives))\n\n    return Promise.all(pending).then(function (results) {\n      const materials = results.slice(0, results.length - 1)\n      const geometries = results[results.length - 1]\n\n      const meshes = []\n\n      for (let i = 0, il = geometries.length; i < il; i++) {\n        const geometry = geometries[i]\n        const primitive = primitives[i]\n\n        // 1. create Mesh\n\n        let mesh\n\n        const material = materials[i]\n\n        if (\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n          primitive.mode === undefined\n        ) {\n          // .isSkinnedMesh isn't in glTF spec. See .markDefs()\n          mesh =\n            meshDef.isSkinnedMesh === true\n              ? new SkinnedMesh(geometry, material)\n              : new Mesh(geometry, material)\n\n          if (mesh.isSkinnedMesh === true && !mesh.geometry.attributes.skinWeight.normalized) {\n            // we normalize floating point skin weight array to fix malformed assets (see #15319)\n            // it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n            mesh.normalizeSkinWeights()\n          }\n\n          if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleStripDrawMode)\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleFanDrawMode)\n          }\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\n          mesh = new LineSegments(geometry, material)\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\n          mesh = new Line(geometry, material)\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\n          mesh = new LineLoop(geometry, material)\n        } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\n          mesh = new Points(geometry, material)\n        } else {\n          throw new Error('THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode)\n        }\n\n        if (Object.keys(mesh.geometry.morphAttributes).length > 0) {\n          updateMorphTargets(mesh, meshDef)\n        }\n\n        mesh.name = meshDef.name || 'mesh_' + meshIndex\n\n        if (geometries.length > 1) mesh.name += '_' + i\n\n        assignExtrasToUserData(mesh, meshDef)\n\n        parser.assignFinalMaterial(mesh)\n\n        meshes.push(mesh)\n      }\n\n      if (meshes.length === 1) {\n        return meshes[0]\n      }\n\n      const group = new Group()\n\n      for (let i = 0, il = meshes.length; i < il; i++) {\n        group.add(meshes[i])\n      }\n\n      return group\n    })\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n   * @param {number} cameraIndex\n   * @return {Promise<THREE.Camera>}\n   */\n  GLTFParser.prototype.loadCamera = function (cameraIndex) {\n    let camera\n    const cameraDef = this.json.cameras[cameraIndex]\n    const params = cameraDef[cameraDef.type]\n\n    if (!params) {\n      console.warn('THREE.GLTFLoader: Missing camera parameters.')\n      return\n    }\n\n    if (cameraDef.type === 'perspective') {\n      camera = new PerspectiveCamera(\n        MathUtils.radToDeg(params.yfov),\n        params.aspectRatio || 1,\n        params.znear || 1,\n        params.zfar || 2e6,\n      )\n    } else if (cameraDef.type === 'orthographic') {\n      camera = new OrthographicCamera(\n        -params.xmag,\n        params.xmag,\n        params.ymag,\n        -params.ymag,\n        params.znear,\n        params.zfar,\n      )\n    }\n\n    if (cameraDef.name) camera.name = cameraDef.name\n\n    assignExtrasToUserData(camera, cameraDef)\n\n    return Promise.resolve(camera)\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n   * @param {number} skinIndex\n   * @return {Promise<Object>}\n   */\n  GLTFParser.prototype.loadSkin = function (skinIndex) {\n    const skinDef = this.json.skins[skinIndex]\n\n    const skinEntry = { joints: skinDef.joints }\n\n    if (skinDef.inverseBindMatrices === undefined) {\n      return Promise.resolve(skinEntry)\n    }\n\n    return this.getDependency('accessor', skinDef.inverseBindMatrices).then(function (accessor) {\n      skinEntry.inverseBindMatrices = accessor\n\n      return skinEntry\n    })\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n   * @param {number} animationIndex\n   * @return {Promise<AnimationClip>}\n   */\n  GLTFParser.prototype.loadAnimation = function (animationIndex) {\n    const json = this.json\n\n    const animationDef = json.animations[animationIndex]\n\n    const pendingNodes = []\n    const pendingInputAccessors = []\n    const pendingOutputAccessors = []\n    const pendingSamplers = []\n    const pendingTargets = []\n\n    for (let i = 0, il = animationDef.channels.length; i < il; i++) {\n      const channel = animationDef.channels[i]\n      const sampler = animationDef.samplers[channel.sampler]\n      const target = channel.target\n      const name = target.node !== undefined ? target.node : target.id // NOTE: target.id is deprecated.\n      const input =\n        animationDef.parameters !== undefined\n          ? animationDef.parameters[sampler.input]\n          : sampler.input\n\n      const output =\n        animationDef.parameters !== undefined\n          ? animationDef.parameters[sampler.output]\n          : sampler.output\n\n      pendingNodes.push(this.getDependency('node', name))\n      pendingInputAccessors.push(this.getDependency('accessor', input))\n      pendingOutputAccessors.push(this.getDependency('accessor', output))\n      pendingSamplers.push(sampler)\n      pendingTargets.push(target)\n    }\n\n    return Promise.all([\n      Promise.all(pendingNodes),\n      Promise.all(pendingInputAccessors),\n      Promise.all(pendingOutputAccessors),\n      Promise.all(pendingSamplers),\n      Promise.all(pendingTargets),\n    ]).then(function (dependencies) {\n      const nodes = dependencies[0]\n      const inputAccessors = dependencies[1]\n      const outputAccessors = dependencies[2]\n      const samplers = dependencies[3]\n      const targets = dependencies[4]\n\n      const tracks = []\n\n      for (let i = 0, il = nodes.length; i < il; i++) {\n        const node = nodes[i]\n        const inputAccessor = inputAccessors[i]\n        const outputAccessor = outputAccessors[i]\n        const sampler = samplers[i]\n        const target = targets[i]\n\n        if (node === undefined) {\n          continue\n        }\n\n        node.updateMatrix()\n        node.matrixAutoUpdate = true\n\n        let TypedKeyframeTrack\n\n        switch (PATH_PROPERTIES[target.path]) {\n          case PATH_PROPERTIES.weights:\n            TypedKeyframeTrack = NumberKeyframeTrack\n            break\n\n          case PATH_PROPERTIES.rotation:\n            TypedKeyframeTrack = QuaternionKeyframeTrack\n            break\n\n          case PATH_PROPERTIES.position:\n          case PATH_PROPERTIES.scale:\n          default:\n            TypedKeyframeTrack = VectorKeyframeTrack\n            break\n        }\n\n        const targetName = node.name ? node.name : node.uuid\n\n        const interpolation =\n          sampler.interpolation !== undefined\n            ? INTERPOLATION[sampler.interpolation]\n            : InterpolateLinear\n\n        const targetNames = []\n\n        if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\n          // Node may be a Group (glTF mesh with several primitives) or a Mesh.\n          node.traverse(function (object) {\n            if (object.isMesh === true && object.morphTargetInfluences) {\n              targetNames.push(object.name ? object.name : object.uuid)\n            }\n          })\n        } else {\n          targetNames.push(targetName)\n        }\n\n        const outputArray = outputAccessor.array\n\n        if (outputAccessor.normalized) {\n          let scale\n\n          if (outputArray.constructor === Int8Array) {\n            scale = 1 / 127\n          } else if (outputArray.constructor === Uint8Array) {\n            scale = 1 / 255\n          } else if (outputArray.constructor == Int16Array) {\n            scale = 1 / 32767\n          } else if (outputArray.constructor === Uint16Array) {\n            scale = 1 / 65535\n          } else {\n            throw new Error('THREE.GLTFLoader: Unsupported output accessor component type.')\n          }\n\n          const scaled = new Float32Array(outputArray.length)\n\n          for (let j = 0, jl = outputArray.length; j < jl; j++) {\n            scaled[j] = outputArray[j] * scale\n          }\n\n          outputArray = scaled\n        }\n\n        for (let j = 0, jl = targetNames.length; j < jl; j++) {\n          const track = new TypedKeyframeTrack(\n            targetNames[j] + '.' + PATH_PROPERTIES[target.path],\n            inputAccessor.array,\n            outputArray,\n            interpolation,\n          )\n\n          // Override interpolation with custom factory method.\n          if (sampler.interpolation === 'CUBICSPLINE') {\n            track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline(result) {\n              // A CUBICSPLINE keyframe in glTF has three output values for each input value,\n              // representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n              // must be divided by three to get the interpolant's sampleSize argument.\n\n              return new GLTFCubicSplineInterpolant(\n                this.times,\n                this.values,\n                this.getValueSize() / 3,\n                result,\n              )\n            }\n\n            // Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n            track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true\n          }\n\n          tracks.push(track)\n        }\n      }\n\n      const name = animationDef.name ? animationDef.name : 'animation_' + animationIndex\n\n      return new AnimationClip(name, undefined, tracks)\n    })\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n   * @param {number} nodeIndex\n   * @return {Promise<Object3D>}\n   */\n  GLTFParser.prototype.loadNode = function (nodeIndex) {\n    const { extensions, json } = this\n    const parser = this\n\n    const meshReferences = json.meshReferences\n    const meshUses = json.meshUses\n\n    const nodeDef = json.nodes[nodeIndex]\n\n    return (function () {\n      const pending = []\n\n      if (nodeDef.mesh !== undefined) {\n        pending.push(\n          parser.getDependency('mesh', nodeDef.mesh).then(function (mesh) {\n            let node\n\n            if (meshReferences[nodeDef.mesh] > 1) {\n              const instanceNum = meshUses[nodeDef.mesh]++\n\n              node = mesh.clone()\n              node.name += '_instance_' + instanceNum\n            } else {\n              node = mesh\n            }\n\n            // if weights are provided on the node, override weights on the mesh.\n            if (nodeDef.weights !== undefined) {\n              node.traverse(function (o) {\n                if (!o.isMesh) return\n\n                for (let i = 0, il = nodeDef.weights.length; i < il; i++) {\n                  o.morphTargetInfluences[i] = nodeDef.weights[i]\n                }\n              })\n            }\n\n            return node\n          }),\n        )\n      }\n\n      if (nodeDef.camera !== undefined) {\n        pending.push(parser.getDependency('camera', nodeDef.camera))\n      }\n\n      if (\n        nodeDef.extensions &&\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL] &&\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light !== undefined\n      ) {\n        pending.push(\n          parser.getDependency('light', nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light),\n        )\n      }\n\n      return Promise.all(pending)\n    })().then(function (objects) {\n      let node\n\n      // .isBone isn't in glTF spec. See .markDefs\n      if (nodeDef.isBone === true) {\n        node = new Bone()\n      } else if (objects.length > 1) {\n        node = new Group()\n      } else if (objects.length === 1) {\n        node = objects[0]\n      } else {\n        node = new Object3D()\n      }\n\n      if (node !== objects[0]) {\n        for (let i = 0, il = objects.length; i < il; i++) {\n          node.add(objects[i])\n        }\n      }\n\n      if (nodeDef.name) {\n        node.userData.name = nodeDef.name\n        node.name = PropertyBinding.sanitizeNodeName(nodeDef.name)\n      }\n\n      assignExtrasToUserData(node, nodeDef)\n\n      if (nodeDef.extensions) addUnknownExtensionsToUserData(extensions, node, nodeDef)\n\n      if (nodeDef.matrix !== undefined) {\n        const matrix = new Matrix4()\n        matrix.fromArray(nodeDef.matrix)\n        node.applyMatrix4(matrix)\n      } else {\n        if (nodeDef.translation !== undefined) {\n          node.position.fromArray(nodeDef.translation)\n        }\n\n        if (nodeDef.rotation !== undefined) {\n          node.quaternion.fromArray(nodeDef.rotation)\n        }\n\n        if (nodeDef.scale !== undefined) {\n          node.scale.fromArray(nodeDef.scale)\n        }\n      }\n\n      parser.associations.set(node, { type: 'nodes', index: nodeIndex })\n\n      return node\n    })\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n   * @param {number} sceneIndex\n   * @return {Promise<Group>}\n   */\n  GLTFParser.prototype.loadScene = (function () {\n    // scene node hierachy builder\n\n    function buildNodeHierachy(nodeId, parentObject, json, parser) {\n      const nodeDef = json.nodes[nodeId]\n\n      return parser\n        .getDependency('node', nodeId)\n        .then(function (node) {\n          if (nodeDef.skin === undefined) return node\n\n          // build skeleton here as well\n\n          let skinEntry\n\n          return parser\n            .getDependency('skin', nodeDef.skin)\n            .then(function (skin) {\n              skinEntry = skin\n\n              const pendingJoints = []\n\n              for (let i = 0, il = skinEntry.joints.length; i < il; i++) {\n                pendingJoints.push(parser.getDependency('node', skinEntry.joints[i]))\n              }\n\n              return Promise.all(pendingJoints)\n            })\n            .then(function (jointNodes) {\n              node.traverse(function (mesh) {\n                if (!mesh.isMesh) return\n\n                const bones = []\n                const boneInverses = []\n\n                for (let j = 0, jl = jointNodes.length; j < jl; j++) {\n                  const jointNode = jointNodes[j]\n\n                  if (jointNode) {\n                    bones.push(jointNode)\n\n                    const mat = new Matrix4()\n\n                    if (skinEntry.inverseBindMatrices !== undefined) {\n                      mat.fromArray(skinEntry.inverseBindMatrices.array, j * 16)\n                    }\n\n                    boneInverses.push(mat)\n                  } else {\n                    console.warn(\n                      'THREE.GLTFLoader: Joint \"%s\" could not be found.',\n                      skinEntry.joints[j],\n                    )\n                  }\n                }\n\n                mesh.bind(new Skeleton(bones, boneInverses), mesh.matrixWorld)\n              })\n\n              return node\n            })\n        })\n        .then(function (node) {\n          // build node hierachy\n\n          parentObject.add(node)\n\n          const pending = []\n\n          if (nodeDef.children) {\n            const children = nodeDef.children\n\n            for (let i = 0, il = children.length; i < il; i++) {\n              const child = children[i]\n              pending.push(buildNodeHierachy(child, node, json, parser))\n            }\n          }\n\n          return Promise.all(pending)\n        })\n    }\n\n    return function loadScene(sceneIndex) {\n      const { extensions, json } = this\n      const sceneDef = json.scenes[sceneIndex]\n      const parser = this\n\n      // Loader returns Group, not Scene.\n      // See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n      const scene = new Group()\n      if (sceneDef.name) {\n        scene.name = sceneDef.name\n      }\n\n      assignExtrasToUserData(scene, sceneDef)\n\n      if (sceneDef.extensions) {\n        addUnknownExtensionsToUserData(extensions, scene, sceneDef)\n      }\n\n      const nodeIds = sceneDef.nodes || []\n\n      const pending = []\n\n      for (let i = 0, il = nodeIds.length; i < il; i++) {\n        pending.push(buildNodeHierachy(nodeIds[i], scene, json, parser))\n      }\n\n      return Promise.all(pending).then(function () {\n        return scene\n      })\n    }\n  })()\n\n  return GLTFLoader\n})()\n\nexport { GLTFLoader }\n"],"names":["InterleavedBuffer","array","stride","this","count","undefined","length","usage","StaticDrawUsage","updateRange","offset","version","uuid","MathUtils","generateUUID","Object","defineProperty","prototype","set","value","assign","isInterleavedBuffer","onUploadCallback","setUsage","copy","source","constructor","copyAt","index1","attribute","index2","i","l","clone","data","arrayBuffers","buffer","_uuid","slice","ib","onUpload","callback","toJSON","Array","call","Uint32Array","type","name","_vector","Vector3","InterleavedBufferAttribute","interleavedBuffer","itemSize","normalized","OrthographicCamera","left","right","top","bottom","near","far","Camera","zoom","view","updateProjectionMatrix","LineBasicMaterial","parameters","Material","color","Color","linewidth","linecap","linejoin","morphTargets","setValues","MeshStandardMaterial","defines","STANDARD","roughness","metalness","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","TangentSpaceNormalMap","normalScale","Vector2","displacementMap","displacementScale","displacementBias","roughnessMap","metalnessMap","alphaMap","envMap","envMapIntensity","refractionRatio","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","morphNormals","vertexTangents","MeshPhysicalMaterial","PHYSICAL","clearcoat","clearcoatMap","clearcoatRoughness","clearcoatRoughnessMap","clearcoatNormalScale","clearcoatNormalMap","reflectivity","sheen","transmission","transmissionMap","PointsMaterial","size","sizeAttenuation","Bone","Object3D","LightShadow","camera","bias","normalBias","radius","mapSize","mapPass","matrix","Matrix4","autoUpdate","needsUpdate","_frustum","Frustum","_frameExtents","_viewportCount","_viewports","Vector4","DirectionalLightShadow","DirectionalLight","intensity","Light","position","DefaultUp","updateMatrix","target","shadow","PointLightShadow","PerspectiveCamera","_cubeDirections","_cubeUps","PointLight","distance","decay","get","Math","PI","power","SpotLightShadow","SpotLight","angle","penumbra","defineProperties","isInterleavedBufferAttribute","applyMatrix4","m","x","getX","y","getY","z","getZ","setXYZ","setX","index","setY","setZ","setW","w","getW","setXY","setXYZW","j","push","BufferAttribute","interleavedBuffers","create","isOrthographicCamera","recursive","setViewOffset","fullWidth","fullHeight","width","height","enabled","offsetX","offsetY","clearViewOffset","dx","dy","cx","cy","scaleW","scaleH","projectionMatrix","makeOrthographic","projectionMatrixInverse","getInverse","meta","object","isLineBasicMaterial","isMeshStandardMaterial","isMeshPhysicalMaterial","isPointsMaterial","isBone","_projScreenMatrix","_lightPositionWorld","_lookTarget","getViewportCount","getFrustum","updateMatrices","light","shadowCamera","shadowMatrix","projScreenMatrix","lookTarget","lightPositionWorld","setFromMatrixPosition","matrixWorld","lookAt","updateMatrixWorld","multiplyMatrices","matrixWorldInverse","setFromProjectionMatrix","multiply","getViewport","viewportIndex","getFrameExtents","toArray","isDirectionalLightShadow","isDirectionalLight","isPointLightShadow","add","up","makeTranslation","isPointLight","isSpotLightShadow","fov","RAD2DEG","aspect","isSpotLight","Cache","files","key","file","remove","clear","DefaultLoadingManager","onLoad","onProgress","onError","scope","isLoading","itemsLoaded","itemsTotal","urlModifier","handlers","onStart","itemStart","url","itemEnd","itemError","resolveURL","setURLModifier","transform","addHandler","regex","loader","removeHandler","indexOf","splice","getHandler","global","lastIndex","test","Loader","manager","crossOrigin","path","resourcePath","requestHeader","load","loadAsync","Promise","resolve","reject","parse","setCrossOrigin","setPath","setResourcePath","setRequestHeader","loading","FileLoader","ImageBitmapLoader","options","premultiplyAlpha","cached","setTimeout","dataUriRegexResult","match","request","mimeType","isBase64","decodeURIComponent","atob","response","responseType","toLowerCase","Uint8Array","charCodeAt","Blob","parser","DOMParser","parseFromString","JSON","error","XMLHttpRequest","open","addEventListener","event","callbacks","status","il","withCredentials","overrideMimeType","header","send","setResponseType","setWithCredentials","setMimeType","isImageBitmapLoader","setOptions","fetch","then","res","blob","createImageBitmap","imageBitmap","catch","e","LoaderUtils","TextDecoder","decode","s","String","fromCharCode","escape","lastIndexOf","substr","ImageLoader","TextureLoader","image","document","createElementNS","onImageLoad","removeEventListener","onImageError","src","texture","Texture","isJPEG","search","format","RGBFormat","RGBAFormat","_start","_end","_inverseMatrix","_ray","Ray","_sphere","Sphere","Line","geometry","material","mode","BufferGeometry","updateMorphTargets","LineLoop","isLine","computeLineDistances","isBufferGeometry","positionAttribute","attributes","lineDistances","fromBufferAttribute","distanceTo","setAttribute","Float32BufferAttribute","isGeometry","vertices","raycast","raycaster","intersects","threshold","params","boundingSphere","computeBoundingSphere","ray","intersectsSphere","localThreshold","scale","localThresholdSq","vStart","vEnd","interSegment","interRay","step","isLineSegments","positions","indices","a","b","fromArray","distanceSqToSegment","origin","point","face","faceIndex","nbVertices","morphAttributes","keys","morphAttribute","morphTargetInfluences","morphTargetDictionary","ml","isLineLoop","LineSegments","_position","Points","testPoint","rayPointDistanceSq","distanceSqToPoint","intersectPoint","closestPointToPoint","distanceToRay","sqrt","isPoints","_offsetMatrix","_identityMatrix","Skeleton","bones","boneInverses","boneMatrices","Float32Array","frame","calculateInverses","SkinnedMesh","Mesh","bindMode","bindMatrix","bindMatrixInverse","CanvasTexture","canvas","mapping","wrapS","wrapT","magFilter","minFilter","anisotropy","inverse","pose","bone","parent","decompose","quaternion","update","boneTexture","getBoneByName","dispose","isSkinnedMesh","skeleton","bind","normalizeSkinWeights","vector","skinWeight","manhattanLength","Infinity","multiplyScalar","force","boneTransform","basePosition","skinIndex","weight","getComponent","boneIndex","addScaledVector","isCanvasTexture","GLTFLoader","dracoLoader","ddsLoader","pluginCallbacks","register","GLTFMaterialsClearcoatExtension","GLTFRegistry","objects","[object Object]","_onError","gltf","content","extensions","plugins","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","asset","Error","GLTFParser","fileLoader","plugin","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","setExtensions","setPlugins","KHR_MATERIALS_CLEARCOAT","extension","lightDefs","lights","loadLight","lightIndex","lightDef","lightNode","range","spot","innerConeAngle","outerConeAngle","getMaterialType","MeshBasicMaterial","extendParams","materialParams","materialDef","pending","opacity","metallicRoughness","pbrMetallicRoughness","isArray","baseColorFactor","baseColorTexture","assignTexture","all","extendMaterialParams","materialIndex","materials","clearcoatFactor","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughnessTexture","clearcoatNormalTexture","BINARY_EXTENSION_CHUNK_TYPES","body","headerView","DataView","magic","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","preload","GLTFMeshStandardSGMaterial","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","join","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","specular","setHex","glossiness","specularMap","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","replace","v","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","fog","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","getDependency","decodeDracoFile","extendTexture","rotation","repeat","texCoord","copySampleValue_","result","values","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","WEBGL_CONSTANTS","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","5126","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipmapNearestFilter","9985","LinearMipmapNearestFilter","9986","NearestMipmapLinearFilter","9987","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","image/png","image/jpeg","addUnknownExtensionsToUserData","knownExtensions","objectDef","userData","gltfExtensions","assignExtrasToUserData","gltfDef","extras","mesh","meshDef","targetNames","createPrimitiveKey","primitiveDef","dracoExtension","attributesKey","sort","createAttributesKey","cache","associations","Map","primitiveCache","navigator","userAgent","textureLoader","addPrimitiveAttributes","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","setIndex","box","Box3","max","min","targets","maxDisplacement","abs","expandByVector","boundingBox","sphere","getCenter","center","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","normal","morphPositions","morphTargetsRelative","addMorphTargets","toTrianglesDrawMode","drawMode","getIndex","getAttribute","numberOfTriangles","newIndices","TriangleFanDrawMode","newGeometry","removeAll","markDefs","getDependencies","dependencies","scene","scenes","animations","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinLength","joints","nodeIndex","nodeLength","nodeDef","skin","_invokeOne","func","_invokeAll","unshift","cacheKey","dependency","loadScene","loadNode","ext","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","buffers","uri","bufferViewDef","bufferViews","sparse","pendingBufferViews","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","bufferAttribute","ibSlice","floor","ibCacheKey","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","textureIndex","URL","self","webkitURL","textureDef","textures","textureExtensions","images","sourceURI","isObjectURL","createObjectURL","revokeObjectURL","flipY","sampler","samplers","mapName","mapDef","isCompressedTexture","gltfReference","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","pointsMaterial","lineMaterial","cachedMaterial","vertexColors","flatShading","uv2","uv","materialType","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","side","DoubleSide","alphaMode","transparent","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","promise","geometryPromise","meshIndex","depthTest","FrontSide","results","geometries","TriangleStripDrawMode","group","Group","cameraIndex","cameraDef","radToDeg","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","node","id","input","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","matrixAutoUpdate","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","traverse","isMesh","outputArray","scaled","jl","track","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","instanceNum","o","PropertyBinding","sanitizeNodeName","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","jointNode","mat","children","child","sceneIndex","sceneDef","nodeIds"],"mappings":"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"}