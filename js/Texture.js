import{E as t,M as i}from"./MathUtils.js";import{bn as e,ai as s,b as n,ah as o,t as r,am as a,w as p,au as h,r as c}from"./constants.js";import{O as m,V as u,a as l}from"./Object3D.js";import{S as f,V as y}from"./BufferGeometry.js";import{P as d}from"./Mesh.js";function g(){m.call(this),this.type="Group"}g.prototype=Object.assign(Object.create(m.prototype),{constructor:g,isGroup:!0});const x=new f,w=new u;function v(t,i,e,s,n,o){this.planes=[void 0!==t?t:new d,void 0!==i?i:new d,void 0!==e?e:new d,void 0!==s?s:new d,void 0!==n?n:new d,void 0!==o?o:new d]}let M;Object.assign(v.prototype,{set:function(t,i,e,s,n,o){const r=this.planes;return r[0].copy(t),r[1].copy(i),r[2].copy(e),r[3].copy(s),r[4].copy(n),r[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){const i=this.planes;for(let e=0;e<6;e++)i[e].copy(t.planes[e]);return this},setFromProjectionMatrix:function(t){const i=this.planes,e=t.elements,s=e[0],n=e[1],o=e[2],r=e[3],a=e[4],p=e[5],h=e[6],c=e[7],m=e[8],u=e[9],l=e[10],f=e[11],y=e[12],d=e[13],g=e[14],x=e[15];return i[0].setComponents(r-s,c-a,f-m,x-y).normalize(),i[1].setComponents(r+s,c+a,f+m,x+y).normalize(),i[2].setComponents(r+n,c+p,f+u,x+d).normalize(),i[3].setComponents(r-n,c-p,f-u,x-d).normalize(),i[4].setComponents(r-o,c-h,f-l,x-g).normalize(),i[5].setComponents(r+o,c+h,f+l,x+g).normalize(),this},intersectsObject:function(t){const i=t.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),x.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(x)},intersectsSprite:function(t){return x.center.set(0,0,0),x.radius=.7071067811865476,x.applyMatrix4(t.matrixWorld),this.intersectsSphere(x)},intersectsSphere:function(t){const i=this.planes,e=t.center,s=-t.radius;for(let t=0;t<6;t++){if(i[t].distanceToPoint(e)<s)return!1}return!0},intersectsBox:function(t){const i=this.planes;for(let e=0;e<6;e++){const s=i[e];if(w.x=s.normal.x>0?t.max.x:t.min.x,w.y=s.normal.y>0?t.max.y:t.min.y,w.z=s.normal.z>0?t.max.z:t.min.z,s.distanceToPoint(w)<0)return!1}return!0},containsPoint:function(t){const i=this.planes;for(let e=0;e<6;e++)if(i[e].distanceToPoint(t)<0)return!1;return!0}});const A=function(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{void 0===M&&(M=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),M.width=t.width,M.height=t.height;const e=M.getContext("2d");t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),i=M}return i.width>2048||i.height>2048?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png")};let b=0;function F(t,e,s,o,m,u,f,d,g,x){Object.defineProperty(this,"id",{value:b++}),this.uuid=i.generateUUID(),this.name="",this.image=void 0!==t?t:F.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:F.DEFAULT_MAPPING,this.wrapS=void 0!==s?s:n,this.wrapT=void 0!==o?o:n,this.magFilter=void 0!==m?m:r,this.minFilter=void 0!==u?u:a,this.anisotropy=void 0!==g?g:1,this.format=void 0!==f?f:p,this.internalFormat=null,this.type=void 0!==d?d:h,this.offset=new y(0,0),this.repeat=new y(1,1),this.center=new y(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new l,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==x?x:c,this.version=0,this.onUpdate=null}F.DEFAULT_IMAGE=void 0,F.DEFAULT_MAPPING=e,F.prototype=Object.assign(Object.create(t.prototype),{constructor:F,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const n=this.image;if(void 0===n.uuid&&(n.uuid=i.generateUUID()),!e&&void 0===t.images[n.uuid]){let i;if(Array.isArray(n)){i=[];for(let t=0,e=n.length;t<e;t++)i.push(A(n[t]))}else i=A(n);t.images[n.uuid]={uuid:n.uuid,url:i}}s.image=n.uuid}return e||(t.textures[this.uuid]=s),s},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==e)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case o:t.x=t.x-Math.floor(t.x);break;case n:t.x=t.x<0?0:1;break;case s:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case o:t.y=t.y-Math.floor(t.y);break;case n:t.y=t.y<0?0:1;break;case s:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(F.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});export{v as F,g as G,F as T};
//# sourceMappingURL=Texture.js.map
