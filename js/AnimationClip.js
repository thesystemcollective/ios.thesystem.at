import{M as t}from"./MathUtils.js";import{bu as e,bx as r,by as n,bw as o,bA as i,bB as s,bC as a,bt as c}from"./constants.js";import{Q as l}from"./Quaternion.js";function u(t,e,r,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(r),this.sampleValues=e,this.valueSize=r}function h(t,e,r,n){u.call(this,t,e,r,n)}Object.assign(u.prototype,{evaluate:function(t){const e=this.parameterPositions;let r=this._cachedIndex,n=e[r],o=e[r-1];t:{e:{let i;r:{n:if(!(t<n)){for(let i=r+2;;){if(void 0===n){if(t<o)break n;return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,t,o)}if(r===i)break;if(o=n,n=e[++r],t<n)break e}i=e.length;break r}if(t>=o)break t;{const s=e[1];t<s&&(r=2,o=s);for(let i=r-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===i)break;if(n=o,o=e[--r-1],t>=o)break e}i=r,r=0}}for(;r<i;){const n=r+i>>>1;t<e[n]?i=n:r=n+1}if(n=e[r],o=e[r-1],void 0===o)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,o,t)}this._cachedIndex=r,this.intervalChanged_(r,o,n)}return this.interpolate_(r,o,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const e=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=t*n;for(let t=0;t!==n;++t)e[t]=r[o+t];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(u.prototype,{beforeStart_:u.prototype.copySampleValue_,afterEnd_:u.prototype.copySampleValue_}),h.prototype=Object.assign(Object.create(u.prototype),{constructor:h,interpolate_:function(t,e,r,n){const o=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=t*s,c=a-s,l=(r-e)/(n-e),u=1-l;for(let t=0;t!==s;++t)o[t]=i[c+t]*u+i[a+t]*l;return o}});const f=new RegExp("[\\[\\]\\.:\\/]","g"),p="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",d=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),y=/(WCOD+)?/.source.replace("WCOD",p),m=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),g=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),b=new RegExp("^"+d+y+m+g+"$"),v=["material","materials","bones"];function N(t,e,r){const n=r||_.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function _(t,e,r){this.path=e,this.parsedPath=r||_.parseTrackName(e),this.node=_.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(N.prototype,{getValue:function(t,e){this.bind();const r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){const r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,o=r.length;n!==o;++n)r[n].setValue(t,e)},bind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()},unbind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}),Object.assign(_,{Composite:N,create:function(t,e,r){return t&&t.isAnimationObjectGroup?new _.Composite(t,e,r):new _(t,e,r)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(f,"")},parseTrackName:function(t){const e=b.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const t=r.nodeName.substring(n+1);-1!==v.indexOf(t)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=t)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(e);if(void 0!==r)return r}if(t.children){const r=function(t){for(let n=0;n<t.length;n++){const o=t[n];if(o.name===e||o.uuid===e)return o;const i=r(o.children);if(i)return i}return null},n=r(t.children);if(n)return n}return null}}),Object.assign(_.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)t[e++]=r[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)r[n]=t[e++]},function(t,e){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)r[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){const r=this.resolvedProperty;for(let n=0,o=r.length;n!==o;++n)r[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){let t=this.node;const e=this.parsedPath,r=e.objectName,n=e.propertyName;let o=e.propertyIndex;if(t||(t=_.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return;if(r){let n=e.objectIndex;switch(r){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===n){n=e;break}break;default:if(void 0===t[r])return;t=t[r]}if(void 0!==n){if(void 0===t[n])return;t=t[n]}}const i=t[n];if(void 0===i){e.nodeName;return}let s=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===n){if(!t.geometry)return;if(!t.geometry.isBufferGeometry)return;if(!t.geometry.morphAttributes)return;void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}a=this.BindingType.ArrayElement,this.resolvedProperty=i,this.propertyIndex=o}else void 0!==i.fromArray&&void 0!==i.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=i):Array.isArray(i)?(a=this.BindingType.EntireArray,this.resolvedProperty=i):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(_.prototype,{_getValue_unbound:_.prototype.getValue,_setValue_unbound:_.prototype.setValue});const k={arraySlice:function(t,e,r){return k.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==r?r:t.length)):t.slice(e,r)},convertArray:function(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,r=new Array(e);for(let t=0;t!==e;++t)r[t]=t;return r.sort((function(e,r){return t[e]-t[r]})),r},sortedArray:function(t,e,r){const n=t.length,o=new t.constructor(n);for(let i=0,s=0;s!==n;++i){const n=r[i]*e;for(let r=0;r!==e;++r)o[s++]=t[n+r]}return o},flattenJSON:function(t,e,r,n){let o=1,i=t[0];for(;void 0!==i&&void 0===i[n];)i=t[o++];if(void 0===i)return;let s=i[n];if(void 0!==s)if(Array.isArray(s))do{s=i[n],void 0!==s&&(e.push(i.time),r.push.apply(r,s)),i=t[o++]}while(void 0!==i);else if(void 0!==s.toArray)do{s=i[n],void 0!==s&&(e.push(i.time),s.toArray(r,r.length)),i=t[o++]}while(void 0!==i);else do{s=i[n],void 0!==s&&(e.push(i.time),r.push(s)),i=t[o++]}while(void 0!==i)},subclip:function(t,e,r,n,o){o=o||30;const i=t.clone();i.name=e;const s=[];for(let t=0;t<i.tracks.length;++t){const e=i.tracks[t],a=e.getValueSize(),c=[],l=[];for(let t=0;t<e.times.length;++t){const i=e.times[t]*o;if(!(i<r||i>=n)){c.push(e.times[t]);for(let r=0;r<a;++r)l.push(e.values[t*a+r])}}0!==c.length&&(e.times=k.convertArray(c,e.times.constructor),e.values=k.convertArray(l,e.values.constructor),s.push(e))}i.tracks=s;let a=1/0;for(let t=0;t<i.tracks.length;++t)a>i.tracks[t].times[0]&&(a=i.tracks[t].times[0]);for(let t=0;t<i.tracks.length;++t)i.tracks[t].shift(-1*a);return i.resetDuration(),i},makeClipAdditive:function(t,r,n,o){void 0===r&&(r=0),void 0===n&&(n=t),(void 0===o||o<=0)&&(o=30);const i=t.tracks.length,s=r/o;for(let e=0;e<i;++e){const r=n.tracks[e],o=r.ValueTypeName;if("bool"===o||"string"===o)continue;const i=t.tracks.find((function(t){return t.name===r.name&&t.ValueTypeName===o}));if(void 0===i)continue;let a=0;const c=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=c/3);let u=0;const h=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);const f=r.times.length-1;let p;if(s<=r.times[0]){const t=a,e=c-a;p=k.arraySlice(r.values,t,e)}else if(s>=r.times[f]){const t=f*c+a,e=t+c-a;p=k.arraySlice(r.values,t,e)}else{const t=r.createInterpolant(),e=a,n=c-a;t.evaluate(s),p=k.arraySlice(t.resultBuffer,e,n)}if("quaternion"===o){(new l).fromArray(p).normalize().conjugate().toArray(p)}const d=i.times.length;for(let t=0;t<d;++t){const e=t*h+u;if("quaternion"===o)l.multiplyQuaternionsFlat(i.values,e,p,0,i.values,e);else{const t=h-2*u;for(let r=0;r<t;++r)i.values[e+r]-=p[r]}}}return t.blendMode=e,t}};function V(t,e,r,n){u.call(this,t,e,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function S(t,e,r,n){u.call(this,t,e,r,n)}function I(t,e,r,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=k.convertArray(e,this.TimeBufferType),this.values=k.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function O(t,e,r){I.call(this,t,e,r)}function T(t,e,r,n){I.call(this,t,e,r,n)}function w(t,e,r,n){I.call(this,t,e,r,n)}function j(t,e,r,n){u.call(this,t,e,r,n)}function A(t,e,r,n){I.call(this,t,e,r,n)}function x(t,e,r,n){I.call(this,t,e,r,n)}function M(t,e,r,n){I.call(this,t,e,r,n)}function B(e,r,n,o){this.name=e,this.tracks=n,this.duration=void 0!==r?r:-1,this.blendMode=void 0!==o?o:c,this.uuid=t.generateUUID(),this.duration<0&&this.resetDuration()}function E(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return w;case"vector":case"vector2":case"vector3":case"vector4":return M;case"color":return T;case"quaternion":return A;case"bool":case"boolean":return O;case"string":return x}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],r=[];k.flattenJSON(t.keys,e,r,"value"),t.times=e,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}V.prototype=Object.assign(Object.create(u.prototype),{constructor:V,DefaultSettings_:{endingStart:r,endingEnd:r},intervalChanged_:function(t,e,r){const i=this.parameterPositions;let s=t-2,a=t+1,c=i[s],l=i[a];if(void 0===c)switch(this.getSettings_().endingStart){case o:s=t,c=2*e-r;break;case n:s=i.length-2,c=e+i[s]-i[s+1];break;default:s=t,c=r}if(void 0===l)switch(this.getSettings_().endingEnd){case o:a=t,l=2*r-e;break;case n:a=1,l=r+i[1]-i[0];break;default:a=t-1,l=e}const u=.5*(r-e),h=this.valueSize;this._weightPrev=u/(e-c),this._weightNext=u/(l-r),this._offsetPrev=s*h,this._offsetNext=a*h},interpolate_:function(t,e,r,n){const o=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=t*s,c=a-s,l=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(r-e)/(n-e),d=p*p,y=d*p,m=-h*y+2*h*d-h*p,g=(1+h)*y+(-1.5-2*h)*d+(-.5+h)*p+1,b=(-1-f)*y+(1.5+f)*d+.5*p,v=f*y-f*d;for(let t=0;t!==s;++t)o[t]=m*i[l+t]+g*i[c+t]+b*i[a+t]+v*i[u+t];return o}}),S.prototype=Object.assign(Object.create(u.prototype),{constructor:S,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(I,{toJSON:function(t){const e=t.constructor;let r;if(void 0!==e.toJSON)r=e.toJSON(t);else{r={name:t.name,times:k.convertArray(t.times,Array),values:k.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(r.interpolation=e)}return r.type=t.ValueTypeName,r}}),Object.assign(I.prototype,{constructor:I,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:i,InterpolantFactoryMethodDiscrete:function(t){return new S(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new h(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new V(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let e;switch(t){case a:e=this.InterpolantFactoryMethodDiscrete;break;case i:e=this.InterpolantFactoryMethodLinear;break;case s:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return a;case this.InterpolantFactoryMethodLinear:return i;case this.InterpolantFactoryMethodSmooth:return s}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const e=this.times;for(let r=0,n=e.length;r!==n;++r)e[r]+=t}return this},scale:function(t){if(1!==t){const e=this.times;for(let r=0,n=e.length;r!==n;++r)e[r]*=t}return this},trim:function(t,e){const r=this.times,n=r.length;let o=0,i=n-1;for(;o!==n&&r[o]<t;)++o;for(;-1!==i&&r[i]>e;)--i;if(++i,0!==o||i!==n){o>=i&&(i=Math.max(i,1),o=i-1);const t=this.getValueSize();this.times=k.arraySlice(r,o,i),this.values=k.arraySlice(this.values,o*t,i*t)}return this},validate:function(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);const r=this.times,n=this.values,o=r.length;0===o&&(t=!1);let i=null;for(let e=0;e!==o;e++){const n=r[e];if("number"==typeof n&&isNaN(n)){t=!1;break}if(null!==i&&i>n){t=!1;break}i=n}if(void 0!==n&&k.isTypedArray(n))for(let e=0,r=n.length;e!==r;++e){const r=n[e];if(isNaN(r)){t=!1;break}}return t},optimize:function(){const t=k.arraySlice(this.times),e=k.arraySlice(this.values),r=this.getValueSize(),n=this.getInterpolation()===s,o=t.length-1;let i=1;for(let s=1;s<o;++s){let o=!1;const a=t[s];if(a!==t[s+1]&&(1!==s||a!==a[0]))if(n)o=!0;else{const t=s*r,n=t-r,i=t+r;for(let s=0;s!==r;++s){const r=e[t+s];if(r!==e[n+s]||r!==e[i+s]){o=!0;break}}}if(o){if(s!==i){t[i]=t[s];const n=s*r,o=i*r;for(let t=0;t!==r;++t)e[o+t]=e[n+t]}++i}}if(o>0){t[i]=t[o];for(let t=o*r,n=i*r,s=0;s!==r;++s)e[n+s]=e[t+s];++i}return i!==t.length?(this.times=k.arraySlice(t,0,i),this.values=k.arraySlice(e,0,i*r)):(this.times=t,this.values=e),this},clone:function(){const t=k.arraySlice(this.times,0),e=k.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}}),O.prototype=Object.assign(Object.create(I.prototype),{constructor:O,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:a,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),T.prototype=Object.assign(Object.create(I.prototype),{constructor:T,ValueTypeName:"color"}),w.prototype=Object.assign(Object.create(I.prototype),{constructor:w,ValueTypeName:"number"}),j.prototype=Object.assign(Object.create(u.prototype),{constructor:j,interpolate_:function(t,e,r,n){const o=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=(r-e)/(n-e);let c=t*s;for(let t=c+s;c!==t;c+=4)l.slerpFlat(o,0,i,c-s,i,c,a);return o}}),A.prototype=Object.assign(Object.create(I.prototype),{constructor:A,ValueTypeName:"quaternion",DefaultInterpolation:i,InterpolantFactoryMethodLinear:function(t){return new j(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),x.prototype=Object.assign(Object.create(I.prototype),{constructor:x,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:a,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),M.prototype=Object.assign(Object.create(I.prototype),{constructor:M,ValueTypeName:"vector"}),Object.assign(B,{parse:function(t){const e=[],r=t.tracks,n=1/(t.fps||1);for(let t=0,o=r.length;t!==o;++t)e.push(E(r[t]).scale(n));return new B(t.name,t.duration,e,t.blendMode)},toJSON:function(t){const e=[],r=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,n=r.length;t!==n;++t)e.push(I.toJSON(r[t]));return n},CreateFromMorphTargetSequence:function(t,e,r,n){const o=e.length,i=[];for(let t=0;t<o;t++){let s=[],a=[];s.push((t+o-1)%o,t,(t+1)%o),a.push(0,1,0);const c=k.getKeyframeOrder(s);s=k.sortedArray(s,1,c),a=k.sortedArray(a,1,c),n||0!==s[0]||(s.push(o),a.push(a[0])),i.push(new w(".morphTargetInfluences["+e[t].name+"]",s,a).scale(1/r))}return new B(t,-1,i)},findByName:function(t,e){let r=t;if(!Array.isArray(t)){const e=t;r=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<r.length;t++)if(r[t].name===e)return r[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,r){const n={},o=/^([\w-]*?)([\d]+)$/;for(let e=0,r=t.length;e<r;e++){const r=t[e],i=r.name.match(o);if(i&&i.length>1){const t=i[1];let e=n[t];e||(n[t]=e=[]),e.push(r)}}const i=[];for(const t in n)i.push(B.CreateFromMorphTargetSequence(t,n[t],e,r));return i},parseAnimation:function(t,e){if(!t)return null;const r=function(t,e,r,n,o){if(0!==r.length){const i=[],s=[];k.flattenJSON(r,i,s,n),0!==i.length&&o.push(new t(e,i,s))}},n=[],o=t.name||"default",i=t.fps||30,s=t.blendMode;let a=t.length||-1;const c=t.hierarchy||[];for(let t=0;t<c.length;t++){const o=c[t].keys;if(o&&0!==o.length)if(o[0].morphTargets){const t={};let e;for(e=0;e<o.length;e++)if(o[e].morphTargets)for(let r=0;r<o[e].morphTargets.length;r++)t[o[e].morphTargets[r]]=-1;for(const r in t){const t=[],i=[];for(let n=0;n!==o[e].morphTargets.length;++n){const n=o[e];t.push(n.time),i.push(n.morphTarget===r?1:0)}n.push(new w(".morphTargetInfluence["+r+"]",t,i))}a=t.length*(i||1)}else{const i=".bones["+e[t].name+"]";r(M,i+".position",o,"pos",n),r(A,i+".quaternion",o,"rot",n),r(M,i+".scale",o,"scl",n)}}if(0===n.length)return null;return new B(o,a,n,s)}}),Object.assign(B.prototype,{resetDuration:function(){let t=0;for(let e=0,r=this.tracks.length;e!==r;++e){const r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new B(this.name,this.duration,t,this.blendMode)}});export{B as A,u as I,h as L,w as N,_ as P,A as Q,M as V};
//# sourceMappingURL=AnimationClip.js.map
